<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>–î–ª—è –º–æ–µ–π –û–ª–∏</title>
    
    <!-- iOS PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#ffffff">
    <link rel="apple-touch-icon" href="https://img.icons8.com/dusk/64/000000/heart-with-arrow.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Caveat:wght@500;700&family=Nunito:wght@500;700;800&family=SF+Mono:wght@400&family=Roboto+Mono:wght@500&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --card-light: rgba(255, 255, 255, 0.65);
            --card-border-light: rgba(255, 255, 255, 0.4);
            --text-main-light: #1d1d1f;
            --text-sub-light: #86868b;
            
            --card-dark: rgba(30, 30, 35, 0.7);
            --card-border-dark: rgba(255, 255, 255, 0.15);
            --text-main-dark: #f0f0f2;
            --text-sub-dark: #a0a0a5;

            --accent: #ff3b30;
            --accent-glow: rgba(255, 59, 48, 0.5);
            
            --holiday-color: #ff9500;
            
            --blur: blur(30px);
            --shadow: 0 10px 40px -10px rgba(0,0,0,0.15);
            
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        body {
            margin: 0; padding: 0;
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, sans-serif;
            background-color: #f5f5f7; /* Fallback */
            color: var(--text-main-light);
            min-height: 100vh;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
            /* Important: Make body transparent so fixed backgrounds show through */
            background: transparent;
            user-select: none;
        }

        /* --- DYNAMIC BACKGROUNDS --- */
        
        .bg-mesh {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; 
            z-index: -2;
            opacity: 0; transition: opacity 0.8s ease-in-out;
            background-size: cover;
        }
        .bg-mesh.active { opacity: 1; }

        /* LIGHT MODE GRADIENTS */
        #bg-snow {
            /* Deeper blue at top to see white snow */
            background: radial-gradient(at 30% 0%, #dbeafe 0%, transparent 60%), 
                        radial-gradient(at 70% 0%, #bfdbfe 0%, transparent 60%),
                        #eff6ff;
        }
        #bg-spring {
            background: radial-gradient(at 10% 10%, #ffe4e6 0%, transparent 50%), 
                        radial-gradient(at 90% 0%, #fecdd3 0%, transparent 50%),
                        #fff1f2;
        }
        #bg-rain {
            /* Darker grey at top for visible rain */
            background: radial-gradient(at 50% 0%, #94a3b8 0%, transparent 70%),
                        #cbd5e1;
        }

        /* DARK MODE GRADIENTS & OVERRIDES */
        body.dark-mode { color: var(--text-main-dark); }
        
        body.dark-mode #bg-snow {
            background: radial-gradient(circle at 50% -20%, #172a45 0%, #0a0a0a 80%);
        }
        body.dark-mode #bg-spring {
            background: radial-gradient(circle at 50% -20%, #3e1f26 0%, #0a0a0a 80%);
        }
        body.dark-mode #bg-rain {
            background: radial-gradient(circle at 50% -20%, #252b36 0%, #050505 80%);
        }

        #canvas-fx { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; pointer-events: none; }

        /* --- GARLAND (Fairy Lights) --- */
        .garland-wrap {
            position: fixed; top: 0; left: 0; width: 100%; height: 60px; z-index: 100;
            display: flex; justify-content: space-between; pointer-events: none;
            opacity: 0; transition: opacity 0.5s; padding: 0 20px;
        }
        .garland-wrap.active { opacity: 1; }

        .string-segment {
            flex: 1; position: relative;
            /* Darker wire for Light Mode so it's visible against sky */
            border-top: 1px solid rgba(80, 80, 80, 0.5);
            border-radius: 50%; height: 20px; margin-top: -8px;
            display: flex; justify-content: space-around;
            transform-origin: top center;
            animation: gentleSway 5s ease-in-out infinite alternate;
        }
        /* Lighter wire for Dark Mode */
        .dark-mode .string-segment { border-top-color: rgba(255,255,255,0.2); }

        .micro-led {
            width: 4px; height: 4px; border-radius: 50%;
            margin-top: -2px;
            background: #fff;
            position: relative;
        }
        
        /* LIGHT MODE LEDS: Stronger colors/shadows to compete with daylight */
        .led-warm { background: #ffb347; box-shadow: 0 0 6px #ff9e2c; }
        .led-cool { background: #5bc0de; box-shadow: 0 0 6px #2a9fd6; }
        .led-pink { background: #ff69b4; box-shadow: 0 0 6px #ff1493; }
        
        /* DARK MODE LEDS: Soft, wide glow */
        .dark-mode .led-warm { background: #ffdfba; box-shadow: 0 0 15px #ffdfba; }
        .dark-mode .led-cool { background: #cceeff; box-shadow: 0 0 15px #cceeff; }
        .dark-mode .led-pink { background: #ffbbcc; box-shadow: 0 0 15px #ffbbcc; }

        @keyframes gentleSway { from { transform: rotate(-1deg) translateY(0); } to { transform: rotate(1deg) translateY(2px); } }

        /* --- CONTROLS --- */
        .control-dock {
            position: fixed; top: calc(15px + var(--safe-top)); left: 50%; transform: translateX(-50%);
            background: rgba(240, 240, 240, 0.6); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            padding: 4px; border-radius: 100px; display: flex; gap: 6px; z-index: 200;
            border: 1px solid rgba(255,255,255,0.4);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        .dark-mode .control-dock { background: rgba(40,40,40,0.6); border-color: rgba(255,255,255,0.1); }

        .dock-btn {
            width: 42px; height: 42px; border-radius: 50%; border: none; background: transparent;
            font-size: 20px; cursor: pointer; display: flex; align-items: center; justify-content: center;
            transition: all 0.2s;
            position: relative;
        }
        .dock-btn.active { background: #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.1); transform: scale(1.05); }
        .dark-mode .dock-btn.active { background: rgba(255,255,255,0.2); }
        .dock-btn:active { transform: scale(0.95); }

        .coin-badge {
            position: absolute; top: -5px; right: -5px;
            background: #FFD700; color: #000; font-size: 10px; font-weight: 800;
            padding: 2px 5px; border-radius: 10px; box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            min-width: 15px;
        }

        /* --- LAYOUT --- */
        .app-layout {
            max-width: 500px; margin: 0 auto;
            padding: calc(90px + var(--safe-top)) 20px 100px;
            position: relative; z-index: 10;
        }
        
        /* Views */
        .view-section { display: none; animation: fadeIn 0.4s ease; }
        .view-section.active-view { display: block; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        header { text-align: center; margin-bottom: 30px; }
        h1 {
            font-family: 'Caveat', cursive; font-size: 56px; margin: 0; line-height: 0.9;
            color: var(--text-main-light); text-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .dark-mode h1 { color: var(--text-main-dark); text-shadow: 0 2px 20px rgba(0,0,0,0.8); }
        
        .subtitle {
            font-size: 13px; font-weight: 700; text-transform: uppercase; letter-spacing: 2px;
            color: var(--text-sub-light); margin-top: 10px;
        }
        .dark-mode .subtitle { color: var(--text-sub-dark); }

        /* --- GLASS PANEL --- */
        .glass-panel {
            background: var(--card-light); backdrop-filter: var(--blur); -webkit-backdrop-filter: var(--blur);
            border: 1px solid var(--card-border-light);
            border-radius: 32px; padding: 24px; margin-bottom: 24px;
            box-shadow: var(--shadow);
            transition: background 0.3s, border-color 0.3s;
        }
        .dark-mode .glass-panel {
            background: var(--card-dark); border-color: var(--card-border-dark);
            box-shadow: 0 10px 40px rgba(0,0,0,0.4);
        }

        /* --- FLIGHT --- */
        .flight-header { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 10px; }
        .city-code { font-size: 32px; font-weight: 800; line-height: 1; letter-spacing: -1px; }
        .city-name { font-size: 12px; font-weight: 600; text-transform: uppercase; color: var(--text-sub-light); }
        .dark-mode .city-name { color: var(--text-sub-dark); }

        #flight-viz { width: 100%; height: 130px; position: relative; }
        
        .track-path { fill: none; stroke: var(--text-sub-light); stroke-width: 2; stroke-dasharray: 6 6; opacity: 0.3; }
        .active-path { fill: none; stroke: var(--accent); stroke-width: 3; stroke-linecap: round; filter: drop-shadow(0 0 8px var(--accent-glow)); }

        #plane-wrapper {
            position: absolute; top: 0; left: 0; width: 40px; height: 40px;
            will-change: transform; pointer-events: auto; /* Enable click */
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            cursor: pointer;
        }
        .plane-emoji { font-size: 38px; line-height: 1; filter: drop-shadow(0 5px 15px rgba(0,0,0,0.2)); transform: rotate(90deg); transition: transform 0.5s; }

        @keyframes barrelRoll {
            0% { transform: rotate(90deg); }
            100% { transform: rotate(450deg); }
        }

        .pct-pill {
            position: absolute; top: -30px;
            background: rgba(255,255,255,0.9); backdrop-filter: blur(12px);
            padding: 5px 12px; border-radius: 12px;
            font-family: 'Roboto Mono', monospace; font-size: 12px; font-weight: 700; color: #000;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1); white-space: nowrap;
        }
        .dark-mode .pct-pill { background: rgba(60,60,60,0.9); color: #fff; box-shadow: 0 4px 15px rgba(0,0,0,0.4); }

        /* TIMER & CALENDAR */
        .countdown {
            text-align: center; font-family: 'Roboto Mono', monospace; font-size: 30px; font-weight: 700;
            margin-top: 15px; color: var(--text-main-light); letter-spacing: -1px;
        }
        .dark-mode .countdown { color: var(--text-main-dark); }
        
        .timer-caption { text-align: center; font-size: 13px; color: var(--text-sub-light); margin-bottom: 5px; }
        .dark-mode .timer-caption { color: var(--text-sub-dark); }
        
        .dates-meta { display: flex; justify-content: space-between; font-size: 11px; font-weight: 700; color: var(--text-sub-light); opacity: 0.6; margin-top: 20px; }
        .dark-mode .dates-meta { color: var(--text-sub-dark); opacity: 0.8; }

        /* CALENDAR GRID */
        .month-title { font-size: 18px; font-weight: 800; margin-bottom: 10px; display: flex; align-items: center; gap: 10px; }
        
        .week-header {
            display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; margin-bottom: 8px;
        }
        .week-day {
            text-align: center; font-size: 11px; font-weight: 800; color: var(--text-sub-light); opacity: 0.5;
        }
        .dark-mode .week-day { color: var(--text-sub-dark); }

        .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 10px; }
        
        .day-item {
            aspect-ratio: 1; border-radius: 14px;
            background: rgba(0,0,0,0.03);
            display: flex; justify-content: center; align-items: center;
            font-size: 15px; font-weight: 700; color: var(--text-sub-light);
            position: relative; cursor: pointer; transition: all 0.2s cubic-bezier(0.2, 0.8, 0.2, 1);
        }
        .dark-mode .day-item { background: rgba(255,255,255,0.06); color: var(--text-main-dark); }

        .day-item.future { opacity: 0.3; cursor: default; }
        
        .day-item.today {
            background: transparent; border: 2px solid var(--accent); color: var(--accent);
            box-shadow: 0 0 20px var(--accent-glow); z-index: 2; transform: scale(1.1);
        }

        .day-item.holiday {
            border: 1px solid var(--holiday-color);
            color: var(--holiday-color);
        }
        
        .day-item.opened {
            background: var(--accent); color: #fff; border-color: var(--accent);
            box-shadow: 0 5px 15px var(--accent-glow);
        }
        
        .day-item.missed {
            background: transparent; border: 1px dashed var(--accent); color: var(--accent);
        }
        
        .day-item:active { transform: scale(0.92); }

        .mini-heart {
            position: absolute; bottom: 3px; right: 3px; font-size: 9px;
            color: rgba(255,255,255,0.9);
            animation: heartBeat 1.5s infinite;
        }
        @keyframes heartBeat {
            0% { transform: scale(1); }
            15% { transform: scale(1.3); }
            30% { transform: scale(1); }
            45% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .holiday-icon {
            position: absolute; top: -6px; right: -6px; font-size: 12px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.2));
            z-index: 3;
        }

        /* --- MODAL --- */
        .modal-layer {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); backdrop-filter: blur(25px); -webkit-backdrop-filter: blur(25px);
            z-index: 2000; opacity: 0; pointer-events: none; transition: opacity 0.3s;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .modal-layer.active { opacity: 1; pointer-events: all; }

        .letter-box {
            background: #fff; width: 100%; border-radius: 40px; padding: 32px; text-align: center;
            transform: scale(0.9) translateY(40px); transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
            box-shadow: 0 25px 80px rgba(0,0,0,0.3);
        }
        .dark-mode .letter-box { background: #1c1c1e; color: #fff; border: 1px solid rgba(255,255,255,0.1); }
        .modal-layer.active .letter-box { transform: scale(1) translateY(0); }

        .quote-text {
            font-family: 'Caveat', cursive; font-size: 30px; line-height: 1.3; margin: 24px 0;
            color: #1d1d1f;
        }
        .dark-mode .quote-text { color: #f5f5f7; }

        .action-btn {
            background: #1d1d1f; color: #fff; border: none; width: 100%; padding: 18px;
            border-radius: 24px; font-weight: 700; font-size: 16px; cursor: pointer;
            transition: transform 0.2s;
        }
        .dark-mode .action-btn { background: #fff; color: #000; }
        .action-btn:active { transform: scale(0.97); }

        /* --- TOAST --- */
        .toast-pill {
            position: fixed; bottom: 40px; left: 50%; transform: translate(-50%, 150px);
            background: rgba(255,255,255,0.95); backdrop-filter: blur(20px);
            padding: 14px 28px; border-radius: 50px; font-weight: 600; color: #000;
            box-shadow: 0 15px 50px rgba(0,0,0,0.2); z-index: 3000;
            display: flex; align-items: center; gap: 10px; white-space: nowrap;
            transition: transform 0.5s cubic-bezier(0.16, 1, 0.3, 1);
        }
        .toast-pill.visible { transform: translate(-50%, 0); }

        /* --- PET GAME STYLES --- */
        .pet-stage {
            height: 380px; display: flex; flex-direction: column; align-items: center; justify-content: center;
            position: relative; overflow: visible;
            border-radius: 24px;
            transition: all 0.5s;
        }
        
        .house-bg {
            position: absolute; top:0; left:0; width:100%; height:100%; 
            z-index: 0; opacity: 0.3; font-size: 150px; 
            display: flex; align-items: center; justify-content: center;
            pointer-events: none; transition: all 0.5s;
        }

        .pet-blob {
            width: 140px; height: 130px; background: #fff;
            border-radius: 50% 50% 45% 45%;
            box-shadow: 0 15px 40px rgba(0,0,0,0.1);
            position: relative; transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
            display: flex; align-items: center; justify-content: center;
            animation: breathe 3s infinite ease-in-out;
            cursor: pointer;
            z-index: 2;
        }
        .pet-blob.sleeping { animation: breathe 6s infinite ease-in-out; opacity: 0.9; }
        .pet-blob.dirty { filter: sepia(0.6) brightness(0.9); }
        .pet-blob.walking { animation: walk 4s infinite linear; }
        .pet-blob:active { transform: scale(0.9) translateY(5px); }
        .dark-mode .pet-blob { background: #f0f0f5; box-shadow: 0 15px 40px rgba(0,0,0,0.5); }
        
        .pet-face { font-size: 50px; position: relative; z-index: 2; pointer-events: none; }
        .pet-acc { position: absolute; font-size: 50px; z-index: 3; pointer-events: none; }
        .pet-zzz { 
            position: absolute; top: -30px; right: -10px; font-size: 24px; font-weight: 800; 
            color: var(--text-sub-light); opacity: 0; 
        }
        .sleeping .pet-zzz { opacity: 1; animation: floatZ 2s infinite; }

        @keyframes breathe { 0%, 100% { transform: scale(1); } 50% { transform: scale(1.03) translateY(-3px); } }
        @keyframes walk { 
            0% { transform: translateX(0) scale(1) rotate(0); }
            25% { transform: translateX(30px) scale(0.95) rotate(5deg); }
            50% { transform: translateX(0) scale(1) rotate(0); }
            75% { transform: translateX(-30px) scale(0.95) rotate(-5deg); }
            100% { transform: translateX(0) scale(1) rotate(0); }
        }
        @keyframes floatZ { 0% { transform: translate(0,0); opacity:0; } 50% { opacity:1; } 100% { transform: translate(10px, -20px); opacity:0; } }

        /* Floating Click Text */
        .click-float {
            position: absolute; font-weight: 800; font-size: 20px; color: #FFD700;
            pointer-events: none; z-index: 100;
            text-shadow: 0 2px 5px rgba(0,0,0,0.2);
            animation: floatUp 0.8s ease-out forwards;
        }
        @keyframes floatUp { to { transform: translateY(-50px); opacity: 0; } }
        
        .stat-bars { width: 100%; margin-top: 20px; display: flex; gap: 8px; justify-content: center; z-index: 5; position: relative; }
        .stat-col { display: flex; flex-direction: column; align-items: center; gap: 2px; flex: 1; }
        .stat-icon { font-size: 14px; }
        .stat-num { font-size: 9px; font-weight: 800; opacity: 0.6; font-family: 'SF Mono', monospace; margin-top: 2px; }
        .progress-bar { width: 100%; height: 6px; background: rgba(0,0,0,0.05); border-radius: 10px; overflow: hidden; }
        .dark-mode .progress-bar { background: rgba(255,255,255,0.1); }
        .progress-fill { height: 100%; transition: width 0.5s; }

        .game-info {
            display: flex; justify-content: space-between; width: 100%; margin-bottom: 5px;
            font-size: 11px; font-weight: 700; color: var(--text-sub-light);
        }
        .streak-fire { color: #FF9500; }

        .pet-thought {
            background: rgba(255,255,255,0.8); padding: 10px 15px; border-radius: 15px;
            position: absolute; top: 10px; font-size: 12px; font-weight: 700; color: #000;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1); opacity: 0; transform: translateY(10px);
            transition: all 0.3s; pointer-events: none; white-space: nowrap; z-index: 10;
        }
        .pet-thought.show { opacity: 1; transform: translateY(-10px); }

        .exp-container {
            width: 100%; margin-top: 5px; margin-bottom: 10px;
            display: flex; flex-direction: column; align-items: center;
        }
        .exp-bar {
            width: 80%; height: 4px; background: rgba(0,0,0,0.1); border-radius: 4px; overflow: hidden;
        }
        .exp-fill {
            height: 100%; background: linear-gradient(90deg, #32ade6, #007aff); width: 0%; transition: width 0.3s;
        }
        .lvl-text {
            font-size: 10px; font-weight: 800; color: var(--text-sub-light); margin-top: 3px;
        }

        .buffs-row {
            display: flex; gap: 5px; justify-content: center; margin-bottom: 5px; min-height: 20px;
        }
        .buff-icon {
            font-size: 12px; background: rgba(255,255,255,0.5); padding: 2px 6px; border-radius: 10px;
            border: 1px solid var(--accent); color: var(--accent); font-weight: 700;
            animation: pulse 1s infinite;
        }
        @keyframes pulse { 0% { transform: scale(1); } 50% { transform: scale(1.1); } 100% { transform: scale(1); } }

        .shop-modal {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 2500;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);
            display: none; align-items: center; justify-content: center; padding: 20px;
        }
        .shop-modal.active { display: flex; }
        
        .shop-tabs { display: flex; gap: 5px; margin-bottom: 10px; overflow-x: auto; padding-bottom: 5px; }
        .shop-tab { 
            padding: 5px 10px; border-radius: 10px; background: rgba(0,0,0,0.05); 
            font-size: 11px; font-weight: 700; white-space: nowrap; cursor: pointer;
        }
        .shop-tab.active { background: var(--accent); color: #fff; }

        .shop-grid {
            display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px;
            max-height: 300px; overflow-y: auto;
        }
        .shop-item {
            background: rgba(0,0,0,0.05); padding: 10px; border-radius: 15px;
            display: flex; flex-direction: column; align-items: center; gap: 5px; cursor: pointer;
            border: 2px solid transparent; text-align: center;
        }
        .dark-mode .shop-item { background: rgba(255,255,255,0.1); color: #fff; }
        .shop-item.owned { border-color: var(--accent); opacity: 0.7; }
        .shop-item.selected { background: var(--accent); color: #fff; }
        .shop-price { font-size: 11px; font-weight: 800; color: var(--holiday-color); }
        .shop-desc { font-size: 9px; opacity: 0.7; line-height: 1.1; margin-bottom: 4px; }

        /* --- FLAPPY GAME --- */
        #view-flappy {
            position: fixed; top:0; left:0; width:100%; height:100%; z-index: 2000;
            background: rgba(0,0,0,0.9); display: none;
            flex-direction: column; align-items: center; justify-content: center;
        }
        #view-flappy.active { display: flex; }
        #flappy-canvas { border: 2px solid #fff; border-radius: 10px; background: #87CEEB; }

        /* --- DEATH --- */
        .dead-filter { filter: grayscale(100%) contrast(1.2); }
        .death-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,0,0.7); z-index: 50; display: none;
            flex-direction: column; align-items: center; justify-content: center;
            border-radius: 24px; color: #fff;
        }
        
        .sleep-overlay {
            position: absolute; top:0; left:0; width:100%; height:100%;
            background: rgba(0,0,10,0.6); z-index: 40; pointer-events: none;
            display: none; border-radius: 24px;
            align-items: center; justify-content: center; color: #fff; font-size: 20px; font-weight: 800;
        }
        .sleep-overlay.active { display: flex; }

    </style>
</head>
<body>

    <!-- Dynamic Backgrounds -->
    <div id="bg-snow" class="bg-mesh"></div>
    <div id="bg-spring" class="bg-mesh"></div>
    <div id="bg-rain" class="bg-mesh"></div>
    <canvas id="canvas-fx"></canvas>

    <div class="control-dock">
        <button class="dock-btn" onclick="setView('calendar')" id="btn-view-cal">üìÖ</button>
        <button class="dock-btn" onclick="setView('pet')" id="btn-view-pet">üè†
            <span class="coin-badge" id="coin-display">0</span>
        </button>
        <div style="width:1px; background:rgba(127,127,127,0.3); height:24px; align-self:center; margin:0 4px;"></div>
        <button class="dock-btn" onclick="setMode('snow')" id="btn-snow">‚ùÑÔ∏è</button>
        <button class="dock-btn" onclick="setMode('spring')" id="btn-spring">üå∏</button>
        <button class="dock-btn" onclick="setMode('rain')" id="btn-rain">üåßÔ∏è</button>
        <div style="width:1px; background:rgba(127,127,127,0.3); height:24px; align-self:center; margin:0 4px;"></div>
        <button class="dock-btn" onclick="toggleGarland()" id="btn-garland">‚ú®</button>
        <button class="dock-btn" onclick="toggleDark()" id="btn-dark">üåó</button>
    </div>

    <div class="garland-wrap" id="garland">
        <!-- JS Generated -->
    </div>

    <div class="app-layout">
        <header>
            <h1 id="header-title">–ú–æ—è –ª—é–±–∏–º–∞—è –ë–∏–±–∞</h1>
            <div class="subtitle">–ë—É–±–∞ —Å—á–∏—Ç–∞–µ—Ç –¥–Ω–∏ –¥–æ –≤—Å—Ç—Ä–µ—á–∏</div>
        </header>

        <!-- VIEW: CALENDAR -->
        <div id="view-calendar" class="view-section active-view">
            <div class="glass-panel">
                <div class="flight-header">
                    <div>
                        <div class="city-code">UFA</div>
                        <div class="city-name">–£—Ñ–∞</div>
                    </div>
                    <div>
                        <div class="city-code">MOW</div>
                        <div class="city-name">–ú–æ—Å–∫–≤–∞</div>
                    </div>
                </div>

                <div id="flight-viz">
                    <svg width="100%" height="100%" style="overflow:visible;">
                        <path id="path-bg" class="track-path" d="" />
                        <path id="path-active" class="active-path" d="" />
                    </svg>
                    <div id="plane-wrapper" onclick="doBarrelRoll()">
                        <div class="pct-pill" id="rt-percent">0.00000%</div>
                        <div class="plane-emoji" id="plane-icon">‚úàÔ∏è</div>
                    </div>
                </div>

                <div class="countdown" id="timer">...</div>
                <div class="timer-caption">–æ—Å—Ç–∞–ª–æ—Å—å –¥–æ –Ω–∞—à–µ–≥–æ –æ—Ç–ø—É—Å–∫–∞</div>
                
                <div class="dates-meta">
                    <span>11 –Ø–Ω–≤</span>
                    <span>12 –ú–∞—è</span>
                </div>
            </div>

            <div id="calendar-root"></div>
        </div>

        <!-- VIEW: PET -->
        <div id="view-pet" class="view-section">
            <div class="glass-panel" style="min-height: 500px;">
                <div class="month-title">
                    üíñ –¢–≤–æ–π –õ—é–±–∏–º–∫–∞
                </div>

                <!-- EXP BAR -->
                <div class="exp-container">
                    <div class="exp-bar"><div class="exp-fill" id="exp-fill"></div></div>
                    <div class="lvl-text" id="lvl-text">–£—Ä–æ–≤–µ–Ω—å 1</div>
                </div>

                <div class="game-info">
                    <span>–ö–ª–∏–∫: <span id="stat-click">1</span> üí∞</span>
                    <span>–ê–≤—Ç–æ: <span id="stat-auto">0</span> üí∞/—Å–µ–∫</span>
                </div>
                <div class="game-info">
                     <span>–°—Ç—Ä–∏–∫: <span class="streak-fire" id="stat-streak">0</span> üî•</span>
                     <span>–ë–∞–ª–∞–Ω—Å: <span style="color:#FFD700" id="stat-balance">0</span> üí∞</span>
                </div>
                
                <div class="pet-stage" id="pet-stage">
                    <div class="house-bg" id="house-bg"></div>
                    <div class="pet-thought" id="pet-thought">–ü—Ä–∏–≤–µ—Ç!</div>
                    <div class="buffs-row" id="buffs-row"></div>
                    
                    <div class="death-overlay" id="death-overlay">
                        <div style="font-size:60px">üëª</div>
                        <div style="font-weight:800; margin:10px 0;">–õ—é–±–∏–º–∫–∞ –ø–æ–∫–∏–Ω—É–ª –Ω–∞—Å...</div>
                        <div style="font-size:12px; margin-bottom:20px; opacity:0.8">–¢—ã –Ω–µ –∑–∞—Ö–æ–¥–∏–ª–∞ –±–æ–ª—å—à–µ 3 –¥–Ω–µ–π</div>
                        <button class="action-btn" style="background:#fff; color:#000;" onclick="resurrectPet()">–í–æ—Å–∫—Ä–µ—Å–∏—Ç—å (–°–±—Ä–æ—Å —Å—Ç—Ä–∏–∫–∞)</button>
                    </div>

                    <div class="sleep-overlay" id="sleep-overlay">–¢—Å—Å! –ü–∏—Ç–æ–º–µ—Ü —Å–ø–∏—Ç üò¥</div>

                    <div class="pet-blob" id="pet-blob" onclick="petClick(event)">
                        <div class="pet-zzz">Zzz...</div>
                        <div class="pet-acc" id="pet-acc-wear"></div>
                        <div class="pet-face" id="pet-face">üò∫</div>
                    </div>

                    <div class="stat-bars">
                        <div class="stat-col">
                            <span class="stat-icon">üçî</span>
                            <div class="progress-bar"><div class="progress-fill" id="bar-hunger" style="background:#ff9500; width:50%"></div></div>
                            <div class="stat-num" id="txt-hunger">50/100</div>
                        </div>
                        <div class="stat-col">
                            <span class="stat-icon">‚ù§Ô∏è</span>
                            <div class="progress-bar"><div class="progress-fill" id="bar-love" style="background:#ff2d55; width:50%"></div></div>
                            <div class="stat-num" id="txt-love">50/100</div>
                        </div>
                        <div class="stat-col">
                            <span class="stat-icon">‚ö°</span>
                            <div class="progress-bar"><div class="progress-fill" id="bar-energy" style="background:#32ade6; width:50%"></div></div>
                            <div class="stat-num" id="txt-energy">50/100</div>
                        </div>
                        <div class="stat-col">
                            <span class="stat-icon">üõÅ</span>
                            <div class="progress-bar"><div class="progress-fill" id="bar-hygiene" style="background:#5ac8fa; width:50%"></div></div>
                            <div class="stat-num" id="txt-hygiene">50/100</div>
                        </div>
                    </div>
                </div>
                
                <div style="display:flex; gap:10px; margin-top:10px;">
                    <button class="action-btn" style="background:#5ac8fa; color:#fff; flex:1; padding:12px;" onclick="washPet()">üõÅ –£–º—ã—Ç—å</button>
                    <button class="action-btn" style="background:#5856d6; color:#fff; flex:1; padding:12px;" id="btn-sleep" onclick="toggleSleep()">üò¥ –°–ø–∞—Ç—å</button>
                </div>

                <div style="display:flex; gap:10px; margin-top:10px;">
                    <button class="action-btn" style="background:#FF9500; color:#fff; flex:1" onclick="startFlappy()">üéÆ –ò–≥—Ä–∞—Ç—å</button>
                    <button class="action-btn" style="background:var(--accent); color:#fff; flex:1" onclick="openShop()">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω</button>
                </div>
                
                <div style="text-align:center; font-size:11px; opacity:0.6; margin-top:10px;">
                    –í 22:00 –ø–æ—Ä–∞ —Å–ø–∞—Ç—å! –í 9, 13, 19 ‚Äî –≤—Ä–µ–º—è –∫—É—à–∞—Ç—å!
                </div>
            </div>
        </div>
    </div>

    <!-- Flappy Mini Game -->
    <div id="view-flappy">
        <div style="color:#fff; font-weight:800; font-size:20px; margin-bottom:10px;">Flappy Heart</div>
        <canvas id="flappy-canvas" width="320" height="480"></canvas>
        <div style="color:#fff; font-size:14px; margin-top:10px;">–¢–∞–ø–∞–π —á—Ç–æ–±—ã –ª–µ—Ç–µ—Ç—å!</div>
        <button class="action-btn" style="margin-top:20px; width:200px; background:#fff; color:#000;" onclick="closeFlappy()">–í—ã—Ö–æ–¥</button>
    </div>

    <!-- Notification -->
    <div class="toast-pill" id="toast">
        <span>üîí</span> <span id="toast-text">...</span>
    </div>

    <!-- Modal -->
    <div class="modal-layer" id="modal">
        <div class="letter-box">
            <div style="font-size: 50px; margin-bottom: 10px;">üíå</div>
            <div style="font-size: 11px; font-weight: 800; opacity: 0.4; text-transform: uppercase;" id="m-date">...</div>
            <div class="quote-text" id="m-text">...</div>
            <div style="font-weight: 700; color: var(--accent); margin-bottom: 30px;" id="m-source">...</div>
            <button class="action-btn" onclick="closeModal()">–õ—é–±–ª—é —Ç–µ–±—è, –ë—É–±–∞ ‚ù§Ô∏è</button>
        </div>
    </div>

    <!-- Shop Modal -->
    <div class="shop-modal" id="shop-modal">
        <div class="glass-panel" style="background: #fff; width: 100%; max-width: 350px;">
            <div class="month-title">üõçÔ∏è –ú–∞–≥–∞–∑–∏–Ω <span style="margin-left:auto; font-size:14px;">üí∞ <span id="shop-coins">0</span></span></div>
            
            <div class="shop-tabs">
                <div class="shop-tab active" onclick="switchShop('food')">üçî –ï–¥–∞</div>
                <div class="shop-tab" onclick="switchShop('wear')">üëó –û–¥–µ–∂–¥–∞</div>
                <div class="shop-tab" onclick="switchShop('house')">üè† –î–æ–º–∏–∫</div>
                <div class="shop-tab" onclick="switchShop('gadget')">ü§ñ –ì–∞–¥–∂–µ—Ç—ã</div>
                <div class="shop-tab" onclick="switchShop('buff')">‚ú® –ó–µ–ª—å—è</div>
                <div class="shop-tab" onclick="switchShop('upgrade')">‚ö° –ù–∞–≤—ã–∫–∏</div>
            </div>

            <div class="shop-grid" id="shop-list"></div>
            <button class="action-btn" style="margin-top:20px;" onclick="closeShop()">–ó–∞–∫—Ä—ã—Ç—å</button>
        </div>
    </div>

    <script>
        // === STRICT TEXT DATA ===
        const START = new Date(2026, 0, 11);
        const END = new Date(2026, 4, 12);
        const DATA_KEY = 'love_cal_v2026';
        const SETTINGS_KEY = 'love_cal_settings_2026';
        const PET_KEY = 'love_cal_pet_advanced_v3_2026';

        const WEEKDAYS = ['–ü–Ω', '–í—Ç', '–°—Ä', '–ß—Ç', '–ü—Ç', '–°–±', '–í—Å'];
        const HOLIDAYS = {
            '1-14': 'üíò', // Feb 14 (Month 1 in JS)
            '1-23': '‚≠ê', // Feb 23
            '2-8': 'üå∑',  // Mar 8
            '4-1': 'üéà',  // May 1
            '4-9': 'üéñÔ∏è'  // May 9
        };

        const quotes = [
            {t: "–ú–æ—è –º–∏–ª–∞—è –ë–∏–±–∞, –º—ã —Å —Ç–æ–±–æ–π –æ–¥–Ω–æ–π –∫—Ä–æ–≤–∏, —Ç—ã –∏ —è. –¢—ã ‚Äî —á–∞—Å—Ç—å –º–µ–Ω—è, –∫–æ—Ç–æ—Ä–∞—è —Å–µ–π—á–∞—Å –¥–∞–ª–µ–∫–æ, –Ω–æ —Å–∫–æ—Ä–æ –º—ã —Å—Ç–∞–Ω–µ–º –æ–¥–Ω–∏–º —Ü–µ–ª—ã–º.", s: "–¢–≤–æ–π –ë—É–±–∞"},
            {t: "–û–ª—è, –∑–Ω–∞–µ—à—å, –∫–∞–∫ –≥–æ–≤–æ—Ä–∏–ª –ú–æ–ª–Ω–∏—è –ú–∞–∫–∫—É–∏–Ω? ¬´–ö—á–∞—É!¬ª –¢–∞–∫ –±—ã—Å—Ç—Ä–æ –±—å–µ—Ç—Å—è –º–æ–µ —Å–µ—Ä–¥—Ü–µ, –∫–æ–≥–¥–∞ —è –≤–∏–∂—É —Ç–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ.", s: "–¢–∞—á–∫–∏ & –ë—É–±–∞"},
            {t: "–Ø –Ω–µ —Ö–æ—á—É –±—ã—Ç—å —á–µ–ª–æ–≤–µ–∫–æ–º, —è —Ö–æ—á—É –±—ã—Ç—å —Å —Ç–æ–±–æ–π! –î–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–∏–¥–µ—Ç—Å—è —Å—Ç–∞—Ç—å –ß–µ–±—É—Ä–∞—à–∫–æ–π –∏ –∂–∏—Ç—å –≤ —Ç–µ–ª–µ—Ñ–æ–Ω–Ω–æ–π –±—É–¥–∫–µ, –≥–ª–∞–≤–Ω–æ–µ ‚Äî —Ä—è–¥–æ–º —Å —Ç–æ–±–æ–π.", s: "–ß–µ–±—É—Ä–∞—à–∫–∞"},
            {t: "–ë–∏–±–∞, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –∑–Ω–∞—á–∏—Ç —Ç–∞–∫ –º–∞–ª–æ, –∫–æ–≥–¥–∞ —Ç—ã –∑–Ω–∞—á–∏—à—å –¥–ª—è –º–µ–Ω—è —Ç–∞–∫ –º–Ω–æ–≥–æ. –¢—ã ‚Äî –º–æ–π –º–∏—Ä.", s: "–ò—Å–∫—Ä–µ–Ω–Ω–µ"},
            {t: "–û—Ö–∞–Ω–∞ ‚Äî –∑–Ω–∞—á–∏—Ç —Å–µ–º—å—è. –ê —Å–µ–º—å—è ‚Äî —ç—Ç–æ –º—ã —Å —Ç–æ–±–æ–π. –ò –≤ —Å–µ–º—å–µ –Ω–∏–∫–æ–≥–æ –Ω–µ –±—Ä–æ—Å–∞—é—Ç –∏ –Ω–µ –∑–∞–±—ã–≤–∞—é—Ç, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –≤ –¥—Ä—É–≥–æ–º –≥–æ—Ä–æ–¥–µ.", s: "–õ–∏–ª–æ –∏ –°—Ç–∏—á"},
            {t: "–£–ª—ã–±–∞–µ–º—Å—è –∏ –º–∞—à–µ–º, –ë–∏–±–∞! –£–ª—ã–±–∞–µ–º—Å—è –∏ –º–∞—à–µ–º! –°–∫–æ—Ä–æ –º—ã –±—É–¥–µ–º —Å–º–µ—è—Ç—å—Å—è –≤–º–µ—Å—Ç–µ, –≥–ª—è–¥—è –¥—Ä—É–≥ –¥—Ä—É–≥—É –≤ –≥–ª–∞–∑–∞.", s: "–ú–∞–¥–∞–≥–∞—Å–∫–∞—Ä"},
            {t: "–û–ª–µ–Ω—å–∫–∞, —Ç—ã –∫—Ä–∞—Å–∏–≤–∞, –∫–∞–∫ —Å–∞–º—ã–π —è—Ä–∫–∏–π –º–∞–π—Å–∫–∏–π —Ä–∞—Å—Å–≤–µ—Ç. –ò —Å–∫–æ—Ä–æ —ç—Ç–æ—Ç —Ä–∞—Å—Å–≤–µ—Ç –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–º –≤–º–µ—Å—Ç–µ.", s: "–¢–≤–æ–π –≤–ª—é–±–ª–µ–Ω–Ω—ã–π"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –±–æ–ª—å—à–µ, —á–µ–º –≤—á–µ—Ä–∞, –Ω–æ –º–µ–Ω—å—à–µ, —á–µ–º –∑–∞–≤—Ç—Ä–∞. –ú–æ—è –ª—é–±–æ–≤—å –∫ —Ç–µ–±–µ —Ä–∞—Å—Ç–µ—Ç —Å –∫–∞–∂–¥—ã–º –¥–Ω–µ–º —Ä–∞–∑–ª—É–∫–∏.", s: "–ù–∞–≤—Å–µ–≥–¥–∞"},
            {t: "–ú—ã —Å—Ç—Ä–æ–∏–ª–∏, —Å—Ç—Ä–æ–∏–ª–∏ –∏ –Ω–∞–∫–æ–Ω–µ—Ü... –ø–æ—Å—Ç—Ä–æ–∏–º –Ω–∞—à–µ —Å—á–∞—Å—Ç—å–µ! –ì–µ–Ω–∞ –∏ –ß–µ–±—É—Ä–∞—à–∫–∞ —Å–º–æ–≥–ª–∏, –∏ –º—ã —Å–º–æ–∂–µ–º.", s: "–ú—É–¥—Ä–æ—Å—Ç—å"},
            {t: "–¢—ã ‚Äî –ø—Ä–∏—á–∏–Ω–∞ –º–æ–µ–π —É–ª—ã–±–∫–∏ —Å–µ–≥–æ–¥–Ω—è, –ë–∏–±–∞. –î–∞–∂–µ —á–µ—Ä–µ–∑ —Ç—ã—Å—è—á–∏ –∫–∏–ª–æ–º–µ—Ç—Ä–æ–≤ —è —á—É–≤—Å—Ç–≤—É—é —Ç–≤–æ–µ —Ç–µ–ø–ª–æ.", s: "–ë—É–±–∞"},
            {t: "–ñ–¥–∞—Ç—å —Ç—è–∂–µ–ª–æ, –º–æ—è —Ö–æ—Ä–æ—à–∞—è, —è –∑–Ω–∞—é. –ù–æ –Ω–∞–≥—Ä–∞–¥–∞ ‚Äî —ç—Ç–æ —Ç—ã, –∏ –∑–∞ —Ç–∞–∫—É—é –Ω–∞–≥—Ä–∞–¥—É —è –≥–æ—Ç–æ–≤ –∂–¥–∞—Ç—å –≤–µ—á–Ω–æ—Å—Ç—å.", s: "–û –≥–ª–∞–≤–Ω–æ–º"},
            {t: "–ë–∏–±–∞, —Ç—ã –º–æ–π –ª—É—á—à–∏–π –¥—Ä—É–≥, –º–æ—è –ª—é–±–æ–≤—å –∏ –º–æ—è –≤—Å–µ–ª–µ–Ω–Ω–∞—è. –ë–µ–∑ —Ç–µ–±—è –≥–æ—Ä–æ–¥ –∫–∞–∂–µ—Ç—Å—è –ø—É—Å—Ç—ã–º.", s: "–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ"},
            {t: "–í –º–æ–µ–º —Å–µ—Ä–¥—Ü–µ –≤—Å–µ–≥–¥–∞ –≤–µ—Å–Ω–∞, –∫–æ–≥–¥–∞ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ, –û–ª—è. –¢–∞–º –≤—Å–µ–≥–¥–∞ –ø–æ—é—Ç –ø—Ç–∏—Ü—ã –∏ —Å–≤–µ—Ç–∏—Ç —Å–æ–ª–Ω—Ü–µ.", s: "–ß—É–≤—Å—Ç–≤–∞"},
            {t: "–Ø —Å–∫—É—á–∞—é –ø–æ —Ç–µ–±–µ 3000. –ù–µ—Ç, 3 –º–∏–ª–ª–∏–æ–Ω–∞! –õ—é–±–ª—é —Ç–µ–±—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ.", s: "–ú—Å—Ç–∏—Ç–µ–ª–∏"},
            {t: "–ö–∞–∂–¥—ã–π –¥–µ–Ω—å ‚Äî —ç—Ç–æ —à–∞–≥ –Ω–∞–≤—Å—Ç—Ä–µ—á—É. –°–µ–≥–æ–¥–Ω—è –º—ã —Å—Ç–∞–ª–∏ –Ω–∞ –æ–¥–∏–Ω –¥–µ–Ω—å –±–ª–∏–∂–µ –∫ –Ω–∞—à–µ–º—É –æ—Ç–ø—É—Å–∫—É!", s: "–ú–æ—Ç–∏–≤–∞—Ü–∏—è"},
            {t: "–¢—ã –¥–µ–ª–∞–µ—à—å –º–µ–Ω—è —Å–∏–ª—å–Ω–µ–µ, –ë–∏–±–∞. –†–∞–¥–∏ –Ω–∞—Å —è –≥–æ—Ç–æ–≤ —Å–≤–µ—Ä–Ω—É—Ç—å –≥–æ—Ä—ã.", s: "–¢–≤–æ—è –æ–ø–æ—Ä–∞"},
            {t: "–Ø —Å —Ç–æ–±–æ–π. –í—Å–µ–≥–¥–∞. –î–∞–∂–µ –µ—Å–ª–∏ —Ç—ã –º–µ–Ω—è –Ω–µ –≤–∏–¥–∏—à—å, —è —Å—Ç–æ—é –∑–∞ —Ç–≤–æ–∏–º –ø–ª–µ—á–æ–º –∏ –¥–µ—Ä–∂—É —Ç–µ–±—è –∑–∞ —Ä—É–∫—É.", s: "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä (–ø–æ—á—Ç–∏)"},
            {t: "–¢—ã ‚Äî –º–æ–π –æ–∫–µ–∞–Ω, –û–ª—è. –ì–ª—É–±–æ–∫–∏–π, –∫—Ä–∞—Å–∏–≤—ã–π –∏ –±–µ—Å–∫–æ–Ω–µ—á–Ω—ã–π. –Ø —Ö–æ—á—É —Ç–æ–Ω—É—Ç—å –≤ —Ç–µ–±–µ.", s: "–†–æ–º–∞–Ω—Ç–∏–∫–∞"},
            {t: "–°–∫–æ—Ä–æ –º—ã –±—É–¥–µ–º –ø–∏—Ç—å –∫–æ—Ñ–µ –≤–º–µ—Å—Ç–µ, –≥—É–ª—è—Ç—å –∑–∞ —Ä—É–∫—É –∏ –Ω–∏–∫—É–¥–∞ –Ω–µ —Å–ø–µ—à–∏—Ç—å. –û–±–µ—â–∞—é.", s: "–ú–µ—á—Ç–∞"},
            {t: "–û–±–Ω–∏–º–∞—é —Ç–µ–±—è –∫—Ä–µ–ø–∫–æ-–∫—Ä–µ–ø–∫–æ, –º–æ—è –º–∞–ª–µ–Ω—å–∫–∞—è –ë–∏–±–∞. –ß—É–≤—Å—Ç–≤—É–µ—à—å?", s: "–î–µ–π—Å—Ç–≤–∏–µ"},
            {t: "–¢—ã ‚Äî –º–æ–µ —Å–æ–ª–Ω—ã—à–∫–æ. –î–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–∞ —É–ª–∏—Ü–µ –ø–∞—Å–º—É—Ä–Ω–æ, —Ç—ã —Å–≤–µ—Ç–∏—à—å –º–Ω–µ –∏–∑ —Ç–µ–ª–µ—Ñ–æ–Ω–∞.", s: "–¢–µ–ª–µ–ø—É–∑–∏–∫–∏"},
            {t: "–ù–∞—à–∞ –≤—Å—Ç—Ä–µ—á–∞ –Ω–µ–∏–∑–±–µ–∂–Ω–∞, –∫–∞–∫ —Ä–∞—Å—Å–≤–µ—Ç. –ù–æ—á—å —Ç–µ–º–Ω–∞, –Ω–æ —Å–æ–ª–Ω—Ü–µ (—ç—Ç–æ —Ç—ã!) –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤–∑–æ–π–¥–µ—Ç.", s: "–£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å"},
            {t: "–Ø –±–µ—Ä–µ–≥—É —Ç–µ–±—è –≤ —Å–∞–º–æ–º –Ω–∞–¥–µ–∂–Ω–æ–º —Å–µ–π—Ñ–µ ‚Äî –≤ —Å–≤–æ–µ–º —Å–µ—Ä–¥—Ü–µ. –ö–ª—é—á —Ç–æ–ª—å–∫–æ —É —Ç–µ–±—è, –û–ª—è.", s: "–°–µ–∫—Ä–µ—Ç"},
            {t: "–¢—ã —Å–∞–º–∞—è-—Å–∞–º–∞—è –ª—É—á—à–∞—è –¥–µ–≤–æ—á–∫–∞ –Ω–∞ —Å–≤–µ—Ç–µ. –ò —Ç—ã ‚Äî –º–æ—è.", s: "–§–∞–∫—Ç"},
            {t: "–ó–Ω–∞–µ—à—å, –¥–∞–∂–µ –®—Ä–µ–∫ –Ω–µ —Ç–∞–∫ –ª—é–±–∏–ª –§–∏–æ–Ω—É —á–µ—Ä–µ–∑ –±–æ–ª–æ—Ç–∞, –∫–∞–∫ —è –ª—é–±–ª—é —Ç–µ–±—è —á–µ—Ä–µ–∑ –≥–æ—Ä–æ–¥–∞.", s: "–®—Ä–µ–∫"},
            {t: "–ú–æ–π –º–∏—Ä –±–µ–∑ —Ç–µ–±—è —á–µ—Ä–Ω–æ-–±–µ–ª—ã–π, –ë–∏–±–∞. –¢—ã –ø—Ä–∏–Ω–æ—Å–∏—à—å –∫—Ä–∞—Å–∫–∏ –≤ –º–æ—é –∂–∏–∑–Ω—å.", s: "–¶–≤–µ—Ç"},
            {t: "–°–∫–æ—Ä–æ –≤—Å–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è. –ú—ã –ø—Ä–æ—Å–Ω–µ–º—Å—è –≤ –æ–¥–Ω–æ–π –∫—Ä–æ–≤–∞—Ç–∏ –∏ –ø–æ–π–º–µ–º, —á—Ç–æ –æ–∂–∏–¥–∞–Ω–∏–µ —Ç–æ–≥–æ —Å—Ç–æ–∏–ª–æ.", s: "–ù–∞–¥–µ–∂–¥–∞"},
            {t: "–ë–∏–±–∞, —Ç—ã –º–æ–π —à—Ç—É—Ä–º–∞–Ω. –ö—É–¥–∞ –±—ã —è –Ω–∏ –µ—Ö–∞–ª, –≤—Å–µ –¥–æ—Ä–æ–≥–∏ –≤–µ–¥—É—Ç –∫ —Ç–µ–±–µ.", s: "–¢–∞—á–∫–∏"},
            {t: "–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ —Å—á–∞—Å—Ç—å–µ –¥—Ä—É–≥–æ–≥–æ –≤–∞–∂–Ω–µ–µ —Ç–≤–æ–µ–≥–æ. –Ø —Ö–æ—á—É, —á—Ç–æ–±—ã —Ç—ã –±—ã–ª–∞ —Å—á–∞—Å—Ç–ª–∏–≤–∞, –û–ª—è.", s: "–•–æ–ª–æ–¥–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ"},
            {t: "–°–ª—É—á–∞–π–Ω–æ—Å—Ç–∏ –Ω–µ —Å–ª—É—á–∞–π–Ω—ã. –¢–æ, —á—Ç–æ –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–ª–∏—Å—å ‚Äî —ç—Ç–æ –ª—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫ —Å—É–¥—å–±—ã.", s: "–ö—É–Ω–≥-—Ñ—É –ü–∞–Ω–¥–∞"},
            {t: "–Ø —Å–º–æ—Ç—Ä—é –Ω–∞ —Ç–≤–æ–µ —Ñ–æ—Ç–æ –∏ –ø–æ–Ω–∏–º–∞—é: —Ä–∞–¥–∏ —ç—Ç–∏—Ö –≥–ª–∞–∑ —è –≥–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—Ç—å –±–µ–∑ –≤—ã—Ö–æ–¥–Ω—ã—Ö, –ª–∏—à—å –±—ã —Å–∫–æ—Ä–µ–µ –ø—Ä–∏–µ—Ö–∞—Ç—å.", s: "–ë—É–±–∞"},
            {t: "–¢—ã ‚Äî –º–æ–π –ª–∏—á–Ω—ã–π —Å–æ—Ä—Ç –≥–µ—Ä–æ–∏–Ω–∞. –Ø –∑–∞–≤–∏—Å–∏–º –æ—Ç —Ç–µ–±—è, –ë–∏–±–∞.", s: "–°—É–º–µ—Ä–∫–∏"},
            {t: "–ï—Å–ª–∏ –±—ã –º–Ω–µ –¥–∞–≤–∞–ª–∏ –º–æ–Ω–µ—Ç—É –∫–∞–∂–¥—ã–π —Ä–∞–∑, –∫–æ–≥–¥–∞ —è –¥—É–º–∞—é –æ —Ç–µ–±–µ, —è –±—ã —É–∂–µ –∫—É–ø–∏–ª –Ω–∞–º –æ—Å—Ç—Ä–æ–≤.", s: "–ë–æ–≥–∞—Ç—Å—Ç–≤–æ"},
            {t: "–¢—ã ‚Äî —á—É–¥–æ. –ú–æ–µ –ª–∏—á–Ω–æ–µ –Ω–æ–≤–æ–≥–æ–¥–Ω–µ–µ —á—É–¥–æ, –∫–æ—Ç–æ—Ä–æ–µ –¥–ª–∏—Ç—Å—è –∫—Ä—É–≥–ª—ã–π –≥–æ–¥.", s: "–í–æ–ª—à–µ–±—Å—Ç–≤–æ"},
            {t: "–ö–∞–∫ —Ç–∞–º –î–∂—É–ª–∏–∞–Ω –≥–æ–≤–æ—Ä–∏–ª? ¬´–Ø –ª—é–±–ª—é, –∫–æ–≥–¥–∞ –º–µ–Ω—è –æ–±–æ–∂–∞—é—Ç!¬ª –ê —è –æ–±–æ–∂–∞—é —Ç–µ–±—è, –º–æ—è –∫–æ—Ä–æ–ª–µ–≤–∞.", s: "–ú–∞–¥–∞–≥–∞—Å–∫–∞—Ä"},
            {t: "–Ø —Å—á–∏—Ç–∞—é –¥–Ω–∏, —á–∞—Å—ã –∏ –º–∏–Ω—É—Ç—ã. –¢–∏–∫-—Ç–∞–∫. –í—Ä–µ–º—è –∏–¥–µ—Ç, –∏ –æ–Ω–æ –∏–≥—Ä–∞–µ—Ç –∑–∞ –Ω–∞—Å.", s: "–í—Ä–µ–º—è"},
            {t: "–¢—ã —Å–Ω–∏—à—å—Å—è –º–Ω–µ –∫–∞–∂–¥—É—é –Ω–æ—á—å. –ò –ø—Ä–æ—Å—ã–ø–∞—Ç—å—Å—è –±–µ–∑ —Ç–µ–±—è ‚Äî —Å–∞–º–æ–µ —Å–ª–æ–∂–Ω–æ–µ.", s: "–°–Ω—ã"},
            {t: "–û–ª—è, —Ç–≤–æ—è —É–ª—ã–±–∫–∞ –æ—Å–≤–µ—â–∞–µ—Ç –º–Ω–µ –ø—É—Ç—å –ª—É—á—à–µ –ª—é–±—ã—Ö —Ñ–∞—Ä.", s: "–¢–∞—á–∫–∏"},
            {t: "–Ø —Ä—è–¥–æ–º. –ü—Ä–æ—Å—Ç–æ –∑–∞–∫—Ä–æ–π –≥–ª–∞–∑–∞ –∏ –ø—Ä–µ–¥—Å—Ç–∞–≤—å. –Ø –∑–¥–µ—Å—å.", s: "–ú–∞–≥–∏—è"},
            {t: "–¢—ã –¥–µ–ª–∞–µ—à—å –º–µ–Ω—è –ª—É—á—à–µ. –†—è–¥–æ–º —Å —Ç–æ–±–æ–π —è —Ö–æ—á—É –±—ã—Ç—å —Å—É–ø–µ—Ä–≥–µ—Ä–æ–µ–º.", s: "–í–ª–∏—è–Ω–∏–µ"},
            {t: "–°–∫–æ—Ä–æ –≤–µ—Å–Ω–∞, –ë–∏–±–∞! –ê –≤–µ—Å–Ω–∞ ‚Äî —ç—Ç–æ –∂–∏–∑–Ω—å, —ç—Ç–æ –ª—é–±–æ–≤—å, —ç—Ç–æ –º—ã.", s: "–ö–∞–ª–µ–Ω–¥–∞—Ä—å"},
            {t: "–Ø –ª—é–±–ª—é, –∫–æ–≥–¥–∞ —Ç—ã –º–µ–Ω—è –Ω–∞–∑—ã–≤–∞–µ—à—å –ë—É–±–æ–π. –≠—Ç–æ –∑–≤—É—á–∏—Ç –∫–∞–∫ –º—É–∑—ã–∫–∞.", s: "–ü—Ä–∏–∑–Ω–∞–Ω–∏–µ"},
            {t: "–ú—ã —Å —Ç–æ–±–æ–π –∫–∞–∫ –ú—ç—Ç—Ä –∏ –ú–∞–∫–∫—É–∏–Ω ‚Äî –ª—É—á—à–∏–µ –¥—Ä—É–∑—å—è –∏ –ª—É—á—à–∞—è –∫–æ–º–∞–Ω–¥–∞.", s: "–¢–∞—á–∫–∏"},
            {t: "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ —Ç–µ—Å—Ç. –ò –º—ã —Å–¥–∞–¥–∏–º –µ–≥–æ –Ω–∞ –æ—Ç–ª–∏—á–Ω–æ.", s: "–£—á–µ–±–∞"},
            {t: "–ú–Ω–µ –Ω–µ –Ω—É–∂–Ω—ã –ø–æ–¥–∞—Ä–∫–∏, –º–Ω–µ –Ω—É–∂–Ω–∞ —Ç—ã. –¢—ã ‚Äî –º–æ–π –≥–ª–∞–≤–Ω—ã–π –ø–æ–¥–∞—Ä–æ–∫.", s: "–ü—Ä–∞–∑–¥–Ω–∏–∫"},
            {t: "–Ø –ª—é–±–ª—é –∫–∞–∂–¥—É—é —Ç–≤–æ—é —á–µ—Ä—Ç–æ—á–∫—É, –∫–∞–∂–¥—É—é —Ç–≤–æ—é —ç–º–æ—Ü–∏—é.", s: "–î–µ—Ç–∞–ª–∏"},
            {t: "–¢—ã ‚Äî –º–æ–π –¥–æ–º, –û–ª—è. –ò —è —É–∂–∞—Å–Ω–æ —Ö–æ—á—É –¥–æ–º–æ–π.", s: "–£—é—Ç"},
            {t: "–ï—â–µ –æ–¥–∏–Ω –¥–µ–Ω—å –∑–∞—á–µ—Ä–∫–Ω—É—Ç. –ú—ã –ø–æ–±–µ–∂–¥–∞–µ–º —ç—Ç–æ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ.", s: "–ü–æ–±–µ–¥–∞"},
            {t: "–ú–∞—Ä—Ç! –ö–æ—Ç—ã –ø–æ—é—Ç, –∞ –º–æ–µ —Å–µ—Ä–¥—Ü–µ –ø–æ–µ—Ç —Ç–≤–æ–µ –∏–º—è: –û-–ª—è! –ë–∏-–±–∞!", s: "–í–µ—Å–Ω–∞"},
            {t: "–¢—ã —Ä–∞—Å—Ü–≤–µ—Ç–∞–µ—à—å, –∫–∞–∫ —Å–∞–º—ã–π –∫—Ä–∞—Å–∏–≤—ã–π —Ü–≤–µ—Ç–æ–∫. –Ø —Ö–æ—á—É –ø–æ–ª–∏–≤–∞—Ç—å —Ç–µ–±—è —Å–≤–æ–µ–π –ª—é–±–æ–≤—å—é.", s: "–°–∞–¥–æ–≤–Ω–∏–∫"},
            {t: "–Ø —Å–∫—É—á–∞—é –ø–æ —Ç–≤–æ–∏–º —Ä—É–∫–∞–º. –•–æ—á—É –¥–µ—Ä–∂–∞—Ç—å –∏—Ö –≤ —Å–≤–æ–∏—Ö –∏ –≥—Ä–µ—Ç—å.", s: "–¢–µ–ø–ª–æ"},
            {t: "–ë–∏–±–∞, —Ç—ã ‚Äî –º–æ—è –±–∞—Ç–∞—Ä–µ–π–∫–∞. –ë–µ–∑ —Ç–µ–±—è —è —Å–∞–∂—É—Å—å.", s: "–≠–Ω–µ—Ä–≥–∏—è"},
            {t: "–°–∫–æ—Ä–æ –ª–µ–¥ —Ä–∞—Å—Ç–∞–µ—Ç, –∏ –º—ã –≤—Å—Ç—Ä–µ—Ç–∏–º—Å—è. –û—Å—Ç–∞–ª–æ—Å—å —Å–æ–≤—Å–µ–º –Ω–µ–º–Ω–æ–≥–æ.", s: "–ü—Ä–æ–≥–Ω–æ–∑"},
            {t: "–¢—ã ‚Äî –º–æ–µ –≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ. –í—Å–µ, —á—Ç–æ —è –¥–µ–ª–∞—é ‚Äî —è –¥–µ–ª–∞—é –¥–ª—è –Ω–∞—Å.", s: "–†–∞–±–æ—Ç–∞"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –¥–æ –õ—É–Ω—ã –∏ –æ–±—Ä–∞—Ç–Ω–æ. –ò –µ—â–µ —Ç—Ä–∏ —Ä–∞–∑–∞ –≤–æ–∫—Ä—É–≥ –ó–µ–º–ª–∏.", s: "–ö–æ—Å–º–æ—Å"},
            {t: "–¢—ã ‚Äî –º–æ—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è. –ù–∏–∫–æ–≥–æ –Ω–µ—Ç –ª—É—á—à–µ —Ç–µ–±—è –≤–æ –≤—Å–µ–º –º–∏—Ä–µ.", s: "–ò—Å—Ç–∏–Ω–∞"},
            {t: "–ü–æ–º–Ω–∏—à—å, –∫–∞–∫ –≤ ¬´–í–≤–µ—Ä—Ö¬ª? ¬´–°–ø–∞—Å–∏–±–æ –∑–∞ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ!¬ª –ù–∞—à–µ –ø—Ä–∏–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è.", s: "–í–≤–µ—Ä—Ö"},
            {t: "–ë–∏–±–∞, –Ω–µ –≥—Ä—É—Å—Ç–∏. –¢–≤–æ–π –ë—É–±–∞ —Å–∫–æ—Ä–æ –ø—Ä–∏–µ–¥–µ—Ç –∏ –∑–∞—Ü–µ–ª—É–µ—Ç —Ç–µ–±—è.", s: "–û–±–µ—â–∞–Ω–∏–µ"},
            {t: "–¢–≤–æ–∏ –≥–ª–∞–∑–∞ ‚Äî –∫–∞–∫ –¥–≤–∞ –æ–∫–µ–∞–Ω–∞. –Ø —Ö–æ—á—É —Å–º–æ—Ç—Ä–µ—Ç—å –≤ –Ω–∏—Ö –≤–µ—á–Ω–æ.", s: "–í–∑–≥–ª—è–¥"},
            {t: "–Ø –≥–æ—Ä–∂—É—Å—å —Ç–æ–±–æ–π, –û–ª—è. –¢—ã —É –º–µ–Ω—è —Ç–∞–∫–∞—è —Å–∏–ª—å–Ω–∞—è.", s: "–ì–æ—Ä–¥–æ—Å—Ç—å"},
            {t: "–ú—ã —Å–ø—Ä–∞–≤–∏–º—Å—è. –ú—ã –∂–µ –±–∞–Ω–¥–∞!", s: "–ö–æ–º–∞–Ω–¥–∞"},
            {t: "–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –Ω–µ –º–æ–∂–µ—à—å —É—Å–Ω—É—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –ª—É—á—à–µ —Å–Ω–æ–≤. –ù–æ –±–µ–∑ —Ç–µ–±—è —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å –≥—Ä—É—Å—Ç–Ω–∞—è. –ñ–¥—É —Ç–µ–±—è.", s: "–ö–ª–∞—Å—Å–∏–∫–∞"},
            {t: "–¢—ã ‚Äî –º–æ—è –∑–≤–µ–∑–¥–æ—á–∫–∞. –°–≤–µ—Ç–∏ –º–Ω–µ —è—Ä—á–µ!", s: "–ù–æ—á—å"},
            {t: "–Ø —Ö–æ—á—É –≥–æ—Ç–æ–≤–∏—Ç—å —Ç–µ–±–µ –∑–∞–≤—Ç—Ä–∞–∫–∏.", s: "–ó–∞–±–æ—Ç–∞"},
            {t: "–ö–∞–∂–¥–∞—è –ø–µ—Å–Ω—è –æ –ª—é–±–≤–∏ —Ç–µ–ø–µ—Ä—å –Ω–∞–ø–æ–º–∏–Ω–∞–µ—Ç –º–Ω–µ –æ —Ç–µ–±–µ.", s: "–ú—É–∑—ã–∫–∞"},
            {t: "–¢—ã ‚Äî –º–æ–π —Å–∞–º—ã–π —Å–ª–∞–¥–∫–∏–π –ø–æ–Ω—á–∏–∫.", s: "–í–∫—É—Å–Ω–æ"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è, –ë–∏–±–∞. –ü—Ä–æ—Å—Ç–æ, —Å–∏–ª—å–Ω–æ –∏ –Ω–∞–≤—Å–µ–≥–¥–∞.", s: "–ü—Ä–æ—Å—Ç–æ"},
            {t: "–°–∫–æ—Ä–æ –∞–ø—Ä–µ–ª—å. –≠—Ç–æ —É–∂–µ —Ñ–∏–Ω–∏—à–Ω–∞—è –ø—Ä—è–º–∞—è!", s: "–í—Ä–µ–º—è"},
            {t: "–Ø –≤–µ—Ä—é –≤ –Ω–∞—Å. –£ –Ω–∞—Å –≤—Å–µ –ø–æ–ª—É—á–∏—Ç—Å—è.", s: "–í–µ—Ä–∞"},
            {t: "–¢—ã ‚Äî –º–∞–≥–∏—è –≤–Ω–µ –•–æ–≥–≤–∞—Ä—Ç—Å–∞.", s: "–ì–∞—Ä—Ä–∏ –ü–æ—Ç—Ç–µ—Ä"},
            {t: "–ú–æ–µ —Å–µ—Ä–¥—Ü–µ –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç —Ç–µ–±–µ. –¶–µ–ª–∏–∫–æ–º –∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é.", s: "–°–æ–±—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å"},
            {t: "–ñ–¥—É –º–æ–º–µ–Ω—Ç–∞, –∫–æ–≥–¥–∞ —É–≤–∏–∂—É —Ç–µ–±—è –Ω–∞ –≤–æ–∫–∑–∞–ª–µ/–≤ –∞—ç—Ä–æ–ø–æ—Ä—Ç—É. –≠—Ç–æ –±—É–¥–µ—Ç –ª—É—á—à–∏–π –º–∏–≥.", s: "–í—Å—Ç—Ä–µ—á–∞"},
            {t: "–¢—ã ‚Äî –º–æ—è —Ä–∞–¥–æ—Å—Ç—å.", s: "–≠–º–æ—Ü–∏–∏"},
            {t: "–Ø —Å–∫—É—á–∞—é –ø–æ —Ç–≤–æ–µ–º—É –≥–æ–ª–æ—Å—É. –ó–≤–æ–Ω–∏ –º–Ω–µ —á–∞—â–µ.", s: "–°–≤—è–∑—å"},
            {t: "–ú—ã —Å —Ç–æ–±–æ–π –∫–∞–∫ –ø–∞–∑–ª. –ò–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏–º.", s: "–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ"},
            {t: "–õ—é–±–∏—Ç—å —Ç–µ–±—è ‚Äî —ç—Ç–æ —Å–∞–º–æ–µ –ª–µ–≥–∫–æ–µ, —á—Ç–æ —è –∫–æ–≥–¥–∞-–ª–∏–±–æ –¥–µ–ª–∞–ª.", s: "–ß—É–≤—Å—Ç–≤–∞"},
            {t: "–¢—ã ‚Äî –º–æ–µ –≤—Å–µ, –û–ª—è.", s: "–ò—Ç–æ–≥"},
            {t: "–ê–ø—Ä–µ–ª—å! –ë–∏–±–∞, —Å–º–æ—Ç—Ä–∏, –º–∞–π —É–∂–µ –Ω–∞ –≥–æ—Ä–∏–∑–æ–Ω—Ç–µ!", s: "–ö–∞–ª–µ–Ω–¥–∞—Ä—å"},
            {t: "–ï—â–µ —á—É—Ç—å-—á—É—Ç—å, –º–æ—è —Ö–æ—Ä–æ—à–∞—è. –ü–æ—Ç–µ—Ä–ø–∏.", s: "–¢–µ—Ä–ø–µ–Ω–∏–µ"},
            {t: "–Ø —É–∂–µ –ø–ª–∞–Ω–∏—Ä—É—é, –∫—É–¥–∞ –º—ã –ø–æ–π–¥–µ–º –∏ —á—Ç–æ –±—É–¥–µ–º –¥–µ–ª–∞—Ç—å.", s: "–ü–ª–∞–Ω—ã"},
            {t: "–¢—ã —á—É–≤—Å—Ç–≤—É–µ—à—å? –í–æ–∑–¥—É—Ö –ø–∞—Ö–Ω–µ—Ç –Ω–∞—à–µ–π –≤—Å—Ç—Ä–µ—á–µ–π.", s: "–ê—Ç–º–æ—Å—Ñ–µ—Ä–∞"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è —Å–∏–ª—å–Ω–µ–µ, —á–µ–º –≤—á–µ—Ä–∞. –ò —Ç–∞–∫ –∫–∞–∂–¥—ã–π –¥–µ–Ω—å.", s: "–ü—Ä–æ–≥—Ä–µ—Å—Å–∏—è"},
            {t: "–¢—ã ‚Äî –º–æ—è –≤–µ—Å–Ω–∞.", s: "–ú–µ—Ç–∞—Ñ–æ—Ä–∞"},
            {t: "–°–∫–æ—Ä–æ—Å—Ç—å! –Ø —Å–∫–æ—Ä–æ—Å—Ç—å! –í—Ä–µ–º—è, –ª–µ—Ç–∏ –±—ã—Å—Ç—Ä–µ–µ –∫ –º–∞—é!", s: "–¢–∞—á–∫–∏"},
            {t: "–î–∂—É–ª–∏–∞–Ω –±—ã —Å–∫–∞–∑–∞–ª: ¬´–ö–∞–∫–∞—è –∂–µ–Ω—â–∏–Ω–∞!¬ª –ò —è —Å –Ω–∏–º —Å–æ–≥–ª–∞—Å–µ–Ω.", s: "–ú–∞–¥–∞–≥–∞—Å–∫–∞—Ä"},
            {t: "–¢—ã —Å–∞–º–∞—è –∫—Ä–∞—Å–∏–≤–∞—è –¥–µ–≤—É—à–∫–∞ –≤ –º–∏—Ä–µ. –ò –≤ –ú–æ—Å–∫–≤–µ. –ò –≤–µ–∑–¥–µ.", s: "–ö–æ–º–ø–ª–∏–º–µ–Ω—Ç"},
            {t: "–Ø —Å—á–∏—Ç–∞—é –¥–∞–∂–µ —Å–µ–∫—É–Ω–¥—ã.", s: "–ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞"},
            {t: "–¢—ã –¥–µ–ª–∞–µ—à—å —ç—Ç–æ—Ç –º–∏—Ä –¥–æ–±—Ä—ã–º.", s: "–î–æ–±—Ä–æ"},
            {t: "–Ø —Ö–æ—á—É –≥—É–ª—è—Ç—å —Å —Ç–æ–±–æ–π –ø–æ–¥ –¥–æ–∂–¥–µ–º.", s: "–†–æ–º–∞–Ω—Ç–∏–∫–∞"},
            {t: "–¢—ã ‚Äî –º–æ–π –ª—É—á—à–∏–π –ø–æ–¥–∞—Ä–æ–∫.", s: "–ü—Ä–∞–∑–¥–Ω–∏–∫"},
            {t: "–°–∫–æ—Ä–æ –≤—Å–µ –∏–∑–º–µ–Ω–∏—Ç—Å—è. –ú—ã –±—É–¥–µ–º —Ä—è–¥–æ–º.", s: "–ë—É–¥—É—â–µ–µ"},
            {t: "–¢—ã ‚Äî –º–æ—è –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–∞—è –ë–∏–±–∞.", s: "–£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å"},
            {t: "–î–∞–≤–∞–π –Ω–∏–∫–æ–≥–¥–∞ –±–æ–ª—å—à–µ –Ω–µ —Ä–∞—Å—Å—Ç–∞–≤–∞—Ç—å—Å—è —Ç–∞–∫ –Ω–∞–¥–æ–ª–≥–æ.", s: "–£–≥–æ–≤–æ—Ä"},
            {t: "–¢—ã –º–Ω–µ —Å–Ω–∏—à—å—Å—è. –ò –≤ —ç—Ç–∏—Ö —Å–Ω–∞—Ö –º—ã —Å—á–∞—Å—Ç–ª–∏–≤—ã.", s: "–°–æ–Ω"},
            {t: "–õ—é–±–æ–≤—å ‚Äî —ç—Ç–æ –∫–æ–≥–¥–∞ –Ω–µ –Ω—É–∂–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç—å ¬´–ø—Ä–æ—Å—Ç–∏¬ª, –Ω–æ —è –ø—Ä–æ—Å—Ç–∏, —á—Ç–æ —É–µ—Ö–∞–ª.", s: "–ò—Å—Ç–æ—Ä–∏—è"},
            {t: "–Ø –≤—Å–µ–≥–¥–∞ –±—É–¥—É –∏—Å–∫–∞—Ç—å —Ç–µ–±—è –≤ —Ç–æ–ª–ø–µ.", s: "–û—Ä–∏–µ–Ω—Ç–∏—Ä"},
            {t: "–¢–≤–æ—è —É–ª—ã–±–∫–∞ ‚Äî –º–æ–µ —Å–æ–ª–Ω—Ü–µ.", s: "–°–≤–µ—Ç"},
            {t: "–Ø –±–µ—Ä–µ–≥—É –∫–∞–∂–¥–æ–µ —Ç–≤–æ–µ —Å–ª–æ–≤–æ.", s: "–¶–µ–Ω–Ω–æ—Å—Ç—å"},
            {t: "–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ —É—á–∏—Ç —Ü–µ–Ω–∏—Ç—å –≤—Ä–µ–º—è. –ú—ã –±—É–¥–µ–º —Ü–µ–Ω–∏—Ç—å –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É.", s: "–£—Ä–æ–∫"},
            {t: "–¢—ã ‚Äî –º–æ–π –∫–æ–º–ø–∞—Å, –û–ª—è.", s: "–ù–∞–≤–∏–≥–∞—Ü–∏—è"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –¥–æ –≥–ª—É–±–∏–Ω—ã –¥—É—à–∏.", s: "–ì–ª—É–±–∏–Ω–∞"},
            {t: "–¢—ã ‚Äî –º–æ–µ —Å–ø–æ–∫–æ–π—Å—Ç–≤–∏–µ.", s: "–î–∑–µ–Ω"},
            {t: "–ï—â–µ –∫–∞–ø–µ–ª—å–∫—É...", s: "–§–∏–Ω–∞–ª"},
            {t: "–Ø —É–∂–µ —Å–æ–±–∏—Ä–∞—é —á–µ–º–æ–¥–∞–Ω –≤ –º—ã—Å–ª—è—Ö.", s: "–°–±–æ—Ä—ã"},
            {t: "–¢—ã –¥–∞–∂–µ –Ω–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—à—å, –∫–∞–∫ —è —Å–æ—Å–∫—É—á–∏–ª—Å—è, –ë–∏–±–∞.", s: "–¢–æ—Å–∫–∞"},
            {t: "–ú–∞–π —É–∂–µ —Å—Ç—É—á–∏—Ç—Å—è –≤ –¥–≤–µ—Ä—å!", s: "–†–∞–¥–æ—Å—Ç—å"},
            {t: "–ú–ê–ô! –ë–∏–±–∞, –º—ã –¥–æ–∂–∏–ª–∏! –£—Ä–∞!", s: "–ü–æ–±–µ–¥–∞"},
            {t: "–û—Å—Ç–∞–ª–∏—Å—å —Å—á–∏—Ç–∞–Ω–Ω—ã–µ –¥–Ω–∏. –°–µ—Ä–¥—Ü–µ –≤—ã–ø—Ä—ã–≥–∏–≤–∞–µ—Ç.", s: "–ü—É–ª—å—Å"},
            {t: "–Ø —É–∂–µ —á—É–≤—Å—Ç–≤—É—é —Ç–≤–æ–∏ –¥—É—Ö–∏.", s: "–û–±–æ–Ω—è–Ω–∏–µ"},
            {t: "–ì–æ—Ç–æ–≤—å—Å—è –∫ —Å–∞–º—ã–º –∫—Ä–µ–ø–∫–∏–º –æ–±–Ω–∏–º–∞—à–∫–∞–º –≤ –º–∏—Ä–µ.", s: "–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ"},
            {t: "–°–∫–æ—Ä–æ —è —É–≤–∏–∂—É —Ç–≤–æ–∏ –≥–ª–∞–∑–∞ –≤–∂–∏–≤—É—é, –∞ –Ω–µ —á–µ—Ä–µ–∑ —ç–∫—Ä–∞–Ω.", s: "–°—á–∞—Å—Ç—å–µ"},
            {t: "–≠—Ç–æ –±—ã–ª–æ –¥–æ–ª–≥–æ, –Ω–æ –º—ã —Å–º–æ–≥–ª–∏. –ú—ã –º–æ–ª–æ–¥—Ü—ã.", s: "–ì–æ—Ä–¥–æ—Å—Ç—å"},
            {t: "–Ø –ª—é–±–ª—é —Ç–µ–±—è –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ, –º–æ—è –û–ª—è.", s: "–ö–æ—Å–º–æ—Å"},
            {t: "–ß–µ–º–æ–¥–∞–Ω —Å–æ–±—Ä–∞–Ω. –ë–∏–ª–µ—Ç –≤ –∫–∞—Ä–º–∞–Ω–µ (–ø–æ—á—Ç–∏).", s: "–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å"},
            {t: "–ñ–¥–∏ –º–µ–Ω—è, –∏ —è –≤–µ—Ä–Ω—É—Å—å. –û—á–µ–Ω—å —Å–∫–æ—Ä–æ.", s: "–ö–ª–∞—Å—Å–∏–∫–∞"},
            {t: "–ö—á–∞—É! –Ø –µ–¥—É –∫ —Ç–µ–±–µ!", s: "–¢–∞—á–∫–∏"},
            {t: "–ó–∞–≤—Ç—Ä–∞ –∏–ª–∏ –ø–æ—Å–ª–µ–∑–∞–≤—Ç—Ä–∞? –£–∂–µ –Ω–µ–≤–∞–∂–Ω–æ, —ç—Ç–æ –°–ö–û–†–û!", s: "–ë–ª–∏–∑–æ—Å—Ç—å"},
            {t: "–ë–ò–ë–ê! –Ø –¢–£–¢! –û–¢–ü–£–°–ö! –ë–£–ë–ê –ü–†–ò–ï–•–ê–õ!", s: "12 –ú–ê–Ø"}
        ];

        let state = {
            opened: JSON.parse(localStorage.getItem(DATA_KEY)) || {},
            settings: { mode: 'snow', garland: false, dark: false },
            pet: JSON.parse(localStorage.getItem(PET_KEY)) || {
                coins: 0,
                clickPower: 1,
                autoIncome: 0,
                hunger: 80,
                love: 80,
                energy: 100,
                hygiene: 100,
                lastLogin: 0,
                streak: 0,
                wear: null,
                house: null,
                inventory: [],
                upgrades: { click: 1, auto: 0 },
                level: 1,
                exp: 0,
                maxExp: 100,
                activeBuffs: [],
                gadgets: { feeder: 0, sleeper: 0 }, // Timestamp when expires
                isDead: false,
                isSleeping: false,
                lastSleepCheck: Date.now()
            }
        };

        // Migrations
        if(state.pet.energy === undefined) state.pet.energy = 100;
        if(state.pet.hygiene === undefined) state.pet.hygiene = 100;
        if(state.pet.level === undefined) { 
            state.pet.level = 1; state.pet.exp = 0; state.pet.maxExp = 100; state.pet.activeBuffs = []; 
        }
        if(state.pet.gadgets === undefined) state.pet.gadgets = { feeder: 0, sleeper: 0 };

        // Shop Content
        const SHOP = {
            food: [
                { id: 'candy', name: '–ö–æ–Ω—Ñ–µ—Ç–∫–∞', ico: 'üç¨', cost: 10, effect: 'h+10', desc: '+10 –°—ã—Ç–æ—Å—Ç–∏' },
                { id: 'cookie', name: '–ü–µ—á–µ–Ω—å–∫–∞', ico: 'üç™', cost: 25, effect: 'h+30', desc: '+30 –°—ã—Ç–æ—Å—Ç–∏' },
                { id: 'burger', name: '–ë—É—Ä–≥–µ—Ä', ico: 'üçî', cost: 50, effect: 'h+60', desc: '+60 –°—ã—Ç–æ—Å—Ç–∏' },
                { id: 'coffee', name: '–ö–æ—Ñ–µ', ico: '‚òï', cost: 40, effect: 'e+40', desc: '+40 –≠–Ω–µ—Ä–≥–∏–∏' },
                { id: 'pizza', name: '–ü–∏—Ü—Ü–∞', ico: 'üçï', cost: 70, effect: 'h+80', desc: '–°—ã—Ç–Ω–æ!' },
                { id: 'sushi', name: '–°—É—à–∏', ico: 'üç£', cost: 120, effect: 'h+50 l+5', desc: '–í–∫—É—Å–Ω–æ! +–õ—é–±–æ–≤—å' },
                { id: 'salad', name: '–°–∞–ª–∞—Ç', ico: 'ü•ó', cost: 60, effect: 'h+40 e+10', desc: '–ü–æ–ª–µ–∑–Ω–æ' },
                { id: 'dark_choco', name: '–¢. –®–æ–∫–æ–ª–∞–¥', ico: 'üç´', cost: 30, effect: 'bad', desc: '–ù–µ –ª—é–±–ª—é...' },
                { id: 'kuraga', name: '–ö—É—Ä–∞–≥–∞', ico: 'üçë', cost: 20, effect: 'bad', desc: '–ë–µ–µ...' }
            ],
            wear: [
                { id: 'bow', name: '–ë–∞–Ω—Ç–∏–∫', ico: 'üéÄ', cost: 200, desc: '–ú–∏–ª–æ—Ç–∞ +100' },
                { id: 'glasses', name: '–û—á–∫–∏', ico: 'üï∂Ô∏è', cost: 350, desc: '–ö—Ä—É—Ç–æ—Å—Ç—å' },
                { id: 'crown', name: '–ö–æ—Ä–æ–Ω–∞', ico: 'üëë', cost: 1000, desc: '–ö–æ—Ä–æ–ª–µ–≤–∞' },
                { id: 'hat', name: '–®–ª—è–ø–∫–∞', ico: 'üëí', cost: 500, desc: '–õ–µ–¥–∏' },
                { id: 'flower', name: '–¶–≤–µ—Ç–æ–∫', ico: 'üå∫', cost: 150, desc: '–í–µ—Å–Ω–∞' }
            ],
            house: [
                { id: 'box', name: '–ö–æ—Ä–æ–±–∫–∞', ico: 'üì¶', cost: 0, desc: '–£—é—Ç–Ω–æ' },
                { id: 'doghouse', name: '–ë—É–¥–∫–∞', ico: 'üè†', cost: 1000, desc: '–°–≤–æ–π —É–≥–æ–ª' },
                { id: 'tent', name: '–ü–∞–ª–∞—Ç–∫–∞', ico: '‚õ∫', cost: 2500, desc: '–ü–æ—Ö–æ–¥' },
                { id: 'cottage', name: '–ö–æ—Ç—Ç–µ–¥–∂', ico: 'üè°', cost: 5000, desc: '–ú–µ—á—Ç–∞' },
                { id: 'castle', name: '–ó–∞–º–æ–∫', ico: 'üè∞', cost: 15000, desc: '–ü—Ä–∏–Ω—Ü–µ—Å—Å–∞' },
                { id: 'island', name: '–û—Å—Ç—Ä–æ–≤', ico: 'üèùÔ∏è', cost: 50000, desc: '–ù–∞—à –æ—Ç–ø—É—Å–∫' }
            ],
            upgrade: [
                { id: 'click_up', name: '–°–∏–ª–∞ –∫–ª–∏–∫–∞', ico: 'üí™', type:'u_click', desc: '–ë–æ–ª—å—à–µ –º–æ–Ω–µ—Ç –∑–∞ –∫–ª–∏–∫' },
                { id: 'auto_up', name: '–ê–≤—Ç–æ-–¥–æ—Ö–æ–¥', ico: 'ü§ñ', type:'u_auto', desc: '–ú–æ–Ω–µ—Ç–∫–∏ –∫–∞–ø–∞—é—Ç —Å–∞–º–∏' }
            ],
            buff: [
                { id: 'sugar_rush', name: '–°–∞—Ö–∞—Ä–Ω—ã–π —Ä—ã–≤–æ–∫', ico: 'üç≠', cost: 50, type:'b_click', dur: 120, val: 2, desc: 'x2 –ö–ª–∏–∫ (2 –º–∏–Ω)' },
                { id: 'caffeine', name: '–ö–æ—Ñ–µ–π–Ω—ã–π –±—É–º', ico: '‚òï', cost: 100, type:'b_auto', dur: 300, val: 2, desc: 'x2 –ê–≤—Ç–æ (5 –º–∏–Ω)' },
                { id: 'love_potion', name: '–ó–µ–ª—å–µ –ª—é–±–≤–∏', ico: 'üß™', cost: 300, type:'b_all', dur: 600, val: 2, desc: 'x2 –í—Å–µ –¥–æ—Ö–æ–¥—ã (10 –º–∏–Ω)' },
                { id: 'lucky_charm', name: '–ó–µ–ª—å–µ —É–¥–∞—á–∏', ico: 'üçÄ', cost: 150, type:'b_luck', dur: 600, val: 2, desc: 'x2 –û–ø—ã—Ç Flappy (10 –º–∏–Ω)' }
            ],
            gadget: [
                { id: 'feeder', name: '–ê–≤—Ç–æ-–∫–æ—Ä–º—É—à–∫–∞', ico: 'ü•£', cost: 2000, dur: 7, desc: '–ö–æ—Ä–º–∏—Ç 7 –¥–Ω–µ–π' },
                { id: 'sleeper', name: '–°–º–∞—Ä—Ç-–ª—é–ª—å–∫–∞', ico: 'üõå', cost: 2000, dur: 7, desc: '–£–∫–ª–∞–¥—ã–≤–∞–µ—Ç 7 –¥–Ω–µ–π' }
            ]
        };

        const THOUGHTS = [
            "–¢—ã –ª—É—á—à–∞—è!", "–•–æ—á—É –∫—É—à–∞—Ç—å...", "–ì–¥–µ –ë—É–±–∞?", "–°–∫—É—á–∞—é...", 
            "–ö–∞–∫–∞—è —Ç—ã –∫—Ä–∞—Å–∏–≤–∞—è!", "–ú—É—Ä-–º—É—Ä!", "–•–æ—á—É –Ω–∞ —Ä—É—á–∫–∏", "–õ—é–±–ª—é —Ç–µ–±—è!",
            "–ú—ã —Å–∫–æ—Ä–æ —É–≤–∏–¥–∏–º—Å—è!", "–¢—ã –º–æ—è –º–∞–º–∞?", "–ö–æ–ø–∏–º –Ω–∞ –¥–æ–º–∏–∫!", "–ö—á–∞—É!"
        ];

        const DOM = {
            mount: document.getElementById('calendar-root'),
            modal: document.getElementById('modal'),
            track: document.getElementById('path-bg'),
            active: document.getElementById('path-active'),
            plane: document.getElementById('plane-wrapper'),
            pct: document.getElementById('rt-percent'),
            toast: document.getElementById('toast'),
            garland: document.getElementById('garland'),
            body: document.body,
            coinDisp: document.getElementById('coin-display')
        };

        function init() {
            const saved = JSON.parse(localStorage.getItem(SETTINGS_KEY));
            if(saved) state.settings = { ...state.settings, ...saved };
            applySettings();
            checkDaily();
            checkCircadianRhythm(true);
            updatePetUI();

            const welcomes = ["–ü—Ä–∏–≤–µ—Ç, –ë–∏–±–∞! ‚ù§Ô∏è", "–°–∫—É—á–∞–ª –ø–æ —Ç–µ–±–µ!", "–¢—ã —á—É–¥–æ! ‚ú®", "–ö–ª–∏–∫–∞–π –ø–∏—Ç–æ–º—Ü–∞!"];
            showToast(welcomes[Math.floor(Math.random()*welcomes.length)]);

            const colors = ['led-warm', 'led-cool', 'led-pink'];
            for(let i=0; i<8; i++) {
                const seg = document.createElement('div'); seg.className = 'string-segment';
                seg.style.animationDelay = `${i * 0.5}s`;
                for(let k=0; k<4; k++) {
                    const led = document.createElement('div');
                    led.className = `micro-led ${colors[(i+k)%3]}`;
                    led.style.top = `${Math.sin(k)*5 + 10}px`; 
                    led.style.animationDelay = `${Math.random()*2}s`;
                    seg.appendChild(led);
                }
                DOM.garland.appendChild(seg);
            }
            
            renderCal();
            calcGraph();
            window.addEventListener('resize', calcGraph);
            requestAnimationFrame(flightLoop);
            setInterval(tick, 1000); tick();
            runParticles();
            
            setInterval(petLoop, 1000);
            setInterval(petBehavior, 4000);
            setInterval(() => checkCircadianRhythm(false), 60000); // Check every minute
        }

        function applySettings() {
            const s = state.settings;
            document.querySelectorAll('.bg-mesh').forEach(b => b.classList.remove('active'));
            document.getElementById(`bg-${s.mode}`).classList.add('active');
            document.querySelectorAll('.dock-btn').forEach(b=>b.classList.remove('active'));
            document.getElementById(`btn-${s.mode}`).classList.add('active');
            DOM.body.classList.toggle('dark-mode', s.dark);
            document.getElementById('btn-dark').classList.toggle('active', s.dark);
            DOM.garland.classList.toggle('active', s.garland);
            document.getElementById('btn-garland').classList.toggle('active', s.garland);
        }
        function saveSettings() { localStorage.setItem(SETTINGS_KEY, JSON.stringify(state.settings)); }
        function savePet() { localStorage.setItem(PET_KEY, JSON.stringify(state.pet)); updatePetUI(); }

        // === PET LOGIC ===
        function checkDaily() {
            if(state.pet.isDead) return;
            const today = new Date().toDateString();
            const now = Date.now();
            if(state.pet.lastLogin && (now - new Date(state.pet.lastLogin).getTime() > 259200000)) {
                state.pet.isDead = true; state.pet.deathDate = now; savePet(); return;
            }
            const yesterday = new Date(Date.now() - 86400000).toDateString();
            if(state.pet.lastLogin !== today) {
                if(state.pet.lastLogin === yesterday) state.pet.streak++;
                else state.pet.streak = 1;
                state.pet.lastLogin = today; 
                state.pet.lastLoginTime = now; 
                const bonus = state.pet.streak * 10;
                state.pet.coins += bonus;
                if(state.pet.streak >= 7) showToast(`–°—Ç—Ä–∏–∫ 7 –¥–Ω–µ–π! –°—É–ø–µ—Ä –±–æ–Ω—É—Å +${bonus} üí∞`);
                else showToast(`–î–µ–Ω—å ${state.pet.streak}! –ë–æ–Ω—É—Å +${bonus} üí∞`);
                savePet();
            }
        }
        if(!state.pet.lastLoginTime) state.pet.lastLoginTime = Date.now();

        function checkCircadianRhythm(isInit) {
            if(state.pet.isDead) return;
            const h = new Date().getHours();
            const now = Date.now();
            
            // Check Auto Gadgets
            const hasFeeder = state.pet.gadgets.feeder > now;
            const hasSleeper = state.pet.gadgets.sleeper > now;

            // Sleep: 22:00 - 08:00
            const shouldSleep = (h >= 22 || h < 8);
            
            if(shouldSleep) {
                if(hasSleeper && !state.pet.isSleeping) {
                    state.pet.isSleeping = true;
                    showToast("–°–º–∞—Ä—Ç-–ª—é–ª—å–∫–∞ —É–ª–æ–∂–∏–ª–∞ –ø–∏—Ç–æ–º—Ü–∞ üõå");
                } else if (!state.pet.isSleeping && isInit) {
                    showThought("–¢—ã –∑–∞–±—ã–ª–∞ –º–µ–Ω—è —É–ª–æ–∂–∏—Ç—å... ü•∫");
                    state.pet.love = Math.max(0, state.pet.love - 10);
                }
            } else {
                if(hasSleeper && state.pet.isSleeping) {
                     state.pet.isSleeping = false; // Auto wake up
                }
            }

            // Hunger Spikes: 9, 13, 19
            if((h === 9 || h === 13 || h === 19) && isInit) {
                if(hasFeeder) {
                    state.pet.hunger = Math.min(100, state.pet.hunger + 30);
                    showToast("–ê–≤—Ç–æ-–∫–æ—Ä–º—É—à–∫–∞ –ø–æ–∫–æ—Ä–º–∏–ª–∞! ü•£");
                } else {
                    state.pet.hunger = Math.max(0, state.pet.hunger - 20);
                    showThought("–í—Ä–µ–º—è –∫—É—à–∞—Ç—å! –Ø –≥–æ–ª–æ–¥–µ–Ω!");
                }
            }
            savePet();
        }

        window.resurrectPet = () => {
            state.pet.isDead = false;
            state.pet.hunger = 50; state.pet.love = 50; state.pet.energy = 50; state.pet.hygiene = 100;
            state.pet.streak = 0; state.pet.lastLoginTime = Date.now();
            state.pet.isSleeping = false;
            savePet(); updatePetUI(); showToast("–° –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º! ‚ù§Ô∏è");
        }

        window.toggleSleep = () => {
            if(state.pet.isDead) return;
            state.pet.isSleeping = !state.pet.isSleeping;
            if(state.pet.isSleeping) showToast("–°–ø–æ–∫–æ–π–Ω–æ–π –Ω–æ—á–∏! üò¥");
            else showToast("–î–æ–±—Ä–æ–µ —É—Ç—Ä–æ! ‚òÄÔ∏è");
            savePet();
        }

        window.washPet = () => {
            if(state.pet.isDead) return;
            if(state.pet.isSleeping) { showToast("–ù–µ –±—É–¥–∏!"); return; }
            state.pet.hygiene = 100;
            showToast("–ë—É–ª—å-–±—É–ª—å! –ß–∏—Å—Ç—ã–π –ø–∏—Ç–æ–º–µ—Ü üßº");
            addExp(5);
            savePet();
        }

        function petLoop() {
            if(state.pet.isDead) return;

            // Auto Income
            let mult = 1;
            const now = Date.now();
            state.pet.activeBuffs = state.pet.activeBuffs.filter(b => b.end > now);
            state.pet.activeBuffs.forEach(b => { if(b.type === 'b_auto' || b.type === 'b_all') mult *= b.val; });

            if(state.pet.autoIncome > 0 && !state.pet.isSleeping) {
                state.pet.coins += (state.pet.autoIncome * mult);
            }
            
            // Decays
            if(!state.pet.isSleeping) {
                if(state.pet.hunger > 0) state.pet.hunger -= 0.5;
                if(state.pet.love > 0) state.pet.love -= 0.2;
                if(state.pet.energy > 0) state.pet.energy -= 0.3;
                if(state.pet.hygiene > 0) state.pet.hygiene -= 0.4;
            } else {
                // Sleeping recovers energy but drains hunger slightly
                if(state.pet.energy < 100) state.pet.energy += 1;
                if(state.pet.hunger > 0) state.pet.hunger -= 0.1;
            }

            // Sleep auto-wake if full energy and day time? No, manual control preferred unless gadget.
            if(state.pet.energy <= 0 && !state.pet.isSleeping) {
                state.pet.isSleeping = true; // Pass out
                showToast("–£–ø–∞–ª –±–µ–∑ —Å–∏–ª... üò¥");
            }
            
            savePet();
        }

        function addExp(amount) {
            state.pet.exp += amount;
            if(state.pet.exp >= state.pet.maxExp) {
                state.pet.level++;
                state.pet.exp -= state.pet.maxExp;
                state.pet.maxExp = Math.floor(state.pet.maxExp * 1.5);
                state.pet.energy = 100;
                state.pet.coins += state.pet.level * 50;
                showToast(`–£—Ä–æ–≤–µ–Ω—å ${state.pet.level}! –≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞! üéâ`);
            }
        }

        function petBehavior() {
            if(state.pet.isDead || state.pet.isSleeping) return;
            const blob = document.getElementById('pet-blob');
            const r = Math.random();
            blob.classList.remove('walking');
            
            if(state.pet.hygiene < 40) showThought("–Ø –≥—Ä—è–∑–Ω—ã–π... üõÅ");
            else if(state.pet.hunger < 20) showThought("–•–æ—á—É –∫—É—à–∞—Ç—å!");
            else if(r > 0.7 && state.pet.energy > 10) showThought();
            else if (r < 0.3) blob.classList.add('walking');
        }

        function updatePetUI() {
            DOM.coinDisp.innerText = Math.floor(state.pet.coins);
            document.getElementById('shop-coins').innerText = Math.floor(state.pet.coins);
            document.getElementById('stat-balance').innerText = Math.floor(state.pet.coins);
            
            document.getElementById('bar-hunger').style.width = state.pet.hunger + '%';
            document.getElementById('txt-hunger').innerText = Math.floor(state.pet.hunger) + '/100';
            document.getElementById('bar-love').style.width = state.pet.love + '%';
            document.getElementById('txt-love').innerText = Math.floor(state.pet.love) + '/100';
            document.getElementById('bar-energy').style.width = state.pet.energy + '%';
            document.getElementById('txt-energy').innerText = Math.floor(state.pet.energy) + '/100';
            document.getElementById('bar-hygiene').style.width = state.pet.hygiene + '%';
            document.getElementById('txt-hygiene').innerText = Math.floor(state.pet.hygiene) + '/100';
            
            // EXP
            const expPct = Math.min(100, (state.pet.exp / state.pet.maxExp) * 100);
            document.getElementById('exp-fill').style.width = expPct + '%';
            document.getElementById('lvl-text').innerText = `–£—Ä–æ–≤–µ–Ω—å ${state.pet.level}`;

            // Buffs & Gadgets
            const buffsDiv = document.getElementById('buffs-row');
            buffsDiv.innerHTML = '';
            const now = Date.now();
            
            if(state.pet.gadgets.feeder > now) {
                const el = document.createElement('div'); el.className = 'buff-icon'; el.innerText = 'ü•£'; buffsDiv.appendChild(el);
            }
            if(state.pet.gadgets.sleeper > now) {
                const el = document.createElement('div'); el.className = 'buff-icon'; el.innerText = 'üõå'; buffsDiv.appendChild(el);
            }

            state.pet.activeBuffs.forEach(b => {
                const el = document.createElement('div');
                el.className = 'buff-icon';
                el.innerText = b.ico;
                buffsDiv.appendChild(el);
            });

            // Stats
            let cMult = 1; let aMult = 1;
            state.pet.activeBuffs.forEach(b => { 
                if(b.type==='b_click'||b.type==='b_all') cMult*=b.val; 
                if(b.type==='b_auto'||b.type==='b_all') aMult*=b.val; 
            });
            document.getElementById('stat-click').innerText = (state.pet.clickPower * cMult).toFixed(1);
            document.getElementById('stat-auto').innerText = (state.pet.autoIncome * aMult).toFixed(1);
            document.getElementById('stat-streak').innerText = state.pet.streak;

            const face = document.getElementById('pet-face');
            const blob = document.getElementById('pet-blob');
            const deathOverlay = document.getElementById('death-overlay');
            const sleepOverlay = document.getElementById('sleep-overlay');

            // Visual States
            deathOverlay.style.display = 'none'; 
            sleepOverlay.classList.remove('active');
            blob.classList.remove('dead-filter', 'sleeping', 'dirty');

            if(state.pet.isDead) {
                deathOverlay.style.display = 'flex'; face.innerText = 'üíÄ'; blob.classList.add('dead-filter');
            } else if (state.pet.isSleeping) {
                sleepOverlay.classList.add('active');
                face.innerText = 'üò¥'; blob.classList.add('sleeping');
                document.getElementById('btn-sleep').innerText = "‚òÄÔ∏è –í—Å—Ç–∞–≤–∞—Ç—å";
            } else {
                document.getElementById('btn-sleep').innerText = "üò¥ –°–ø–∞—Ç—å";
                if(state.pet.hygiene < 50) blob.classList.add('dirty');
                
                if(state.pet.hygiene < 30) face.innerText = 'ü§¢';
                else if(state.pet.hunger < 30) face.innerText = 'ü•∫';
                else if(state.pet.love > 90) face.innerText = 'üòª';
                else face.innerText = 'üò∫';
            }

            document.getElementById('pet-acc-wear').innerText = state.pet.wear ? state.pet.wear.ico : '';
            const bg = document.getElementById('house-bg');
            if(state.pet.house && state.pet.house.id !== 'box') bg.innerText = state.pet.house.ico;
            else bg.innerText = 'üì¶';
        }

        window.petClick = (e) => {
            if(state.pet.isDead) return;
            const blob = document.getElementById('pet-blob');
            if(state.pet.isSleeping) { showToast("–¢—Å—Å! –ü–∏—Ç–æ–º–µ—Ü —Å–ø–∏—Ç üò¥"); return; }
            
            blob.style.transform = 'scale(0.95)';
            setTimeout(()=>blob.style.transform = 'scale(1)', 100);

            let mult = 1;
            state.pet.activeBuffs.forEach(b => { if(b.type==='b_click'||b.type==='b_all') mult *= b.val; });
            const gain = state.pet.clickPower * mult;

            state.pet.coins += gain;
            state.pet.love = Math.min(100, state.pet.love + 1);
            state.pet.energy = Math.max(0, state.pet.energy - 0.5);
            addExp(1);
            
            const float = document.createElement('div');
            float.className = 'click-float';
            float.innerText = `+${gain.toFixed(0)}`;
            float.style.left = (e.clientX - 10) + 'px';
            float.style.top = (e.clientY - 40) + 'px';
            document.body.appendChild(float);
            setTimeout(()=>float.remove(), 800);
            savePet();
        };

        function showThought(forcedText) {
            const th = document.getElementById('pet-thought');
            th.innerText = forcedText || THOUGHTS[Math.floor(Math.random()*THOUGHTS.length)];
            th.classList.add('show');
            setTimeout(() => th.classList.remove('show'), 2000);
        }

        // === MINI GAME: FLAPPY HEART ===
        let gameLoop, birdY, birdV, pipes, score, gameActive = false, birdR = 0;
        const cvs = document.getElementById('flappy-canvas');
        const ctx = cvs.getContext('2d');

        window.startFlappy = () => {
            if(state.pet.isDead) return;
            if(state.pet.isSleeping) { showToast("–ü–∏—Ç–æ–º–µ—Ü —Å–ø–∏—Ç!"); return; }
            if(state.pet.energy < 10) { showToast("–°–ª–∏—à–∫–æ–º –º–∞–ª–æ —ç–Ω–µ—Ä–≥–∏–∏! üò¥"); return; }
            
            document.getElementById('view-flappy').classList.add('active');
            birdY = 200; birdV = 0; pipes = []; score = 0; birdR = 0;
            gameActive = true;
            cvs.onclick = () => { birdV = -5; }; 
            gameLoop = setInterval(flappyLoop, 20);
        }

        window.closeFlappy = () => {
            clearInterval(gameLoop); gameActive = false;
            document.getElementById('view-flappy').classList.remove('active');
        }

        function flappyLoop() {
            if(!gameActive) return;
            birdV += 0.25; 
            birdY += birdV;
            birdR = Math.min(Math.PI / 4, Math.max(-Math.PI / 4, (birdV * 0.1)));
            
            if(pipes.length === 0 || pipes[pipes.length-1].x < 150) {
                pipes.push({ x: 320, h: Math.random()*200 + 50 });
            }
            pipes.forEach(p => p.x -= 2);
            if(pipes[0].x < -50) { pipes.shift(); score++; addExp(5); }

            if(birdY > 480 || birdY < 0) return gameOver();
            pipes.forEach(p => {
                if(p.x < 35 && p.x > 5 && (birdY < p.h || birdY > p.h + 120)) return gameOver();
            });

            ctx.fillStyle = "#87CEEB"; ctx.fillRect(0,0,320,480);
            
            // Draw rotated bird
            ctx.save();
            ctx.translate(25, birdY);
            ctx.rotate(birdR);
            ctx.font = "24px Arial"; ctx.fillText("‚ù§Ô∏è", -10, 10);
            ctx.restore();
            
            ctx.fillStyle = "#75aa31";
            pipes.forEach(p => {
                ctx.fillRect(p.x, 0, 40, p.h);
                ctx.fillRect(p.x, p.h+120, 40, 480);
            });
            ctx.fillStyle = "#fff"; ctx.font = "bold 20px Nunito";
            ctx.fillText("Score: " + score, 10, 30);
            ctx.fillText("Coins: " + (score*2), 10, 50);
        }

        function gameOver() {
            clearInterval(gameLoop); gameActive = false;
            // Luck Potion Check
            let luck = 1;
            state.pet.activeBuffs.forEach(b => { if(b.type==='b_luck') luck = b.val; });
            
            const reward = score * 2;
            const expGain = (score * 2) * luck;
            
            state.pet.coins += reward;
            state.pet.energy = Math.max(0, state.pet.energy - 10);
            addExp(expGain);
            savePet();
            alert(`–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞! –°—á–µ—Ç: ${score}\n–ú–æ–Ω–µ—Ç—ã: ${reward} üí∞\n–û–ø—ã—Ç: ${expGain} XP`);
            closeFlappy();
        }

        // === SHOP ===
        let currentShopTab = 'food';
        window.openShop = () => {
            if(state.pet.isDead) return;
            document.getElementById('shop-modal').classList.add('active');
            switchShop('food');
        }
        window.closeShop = () => document.getElementById('shop-modal').classList.remove('active');

        window.switchShop = (tab) => {
            currentShopTab = tab;
            document.querySelectorAll('.shop-tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.shop-tab').forEach(t => { if(t.innerText.includes(getTabName(tab))) t.classList.add('active'); });
            renderShop();
        }

        function getTabName(t) {
            if(t==='food') return '–ï–¥–∞';
            if(t==='wear') return '–û–¥–µ–∂–¥–∞';
            if(t==='house') return '–î–æ–º–∏–∫';
            if(t==='gadget') return '–ì–∞–¥–∂–µ—Ç—ã';
            if(t==='buff') return '–ó–µ–ª—å—è';
            return '–ù–∞–≤—ã–∫–∏';
        }

        function renderShop() {
            const lst = document.getElementById('shop-list');
            lst.innerHTML = '';
            let items = [];
            
            if(currentShopTab === 'upgrade') {
                const cLvl = state.pet.upgrades.click;
                const aLvl = state.pet.upgrades.auto;
                const clickCost = cLvl >= 10 ? 'MAX' : Math.floor(100 * Math.pow(2.5, cLvl));
                const autoCost = aLvl >= 10 ? 'MAX' : Math.floor(200 * Math.pow(2.5, aLvl));
                items = [
                    { ...SHOP.upgrade[0], cost: clickCost, lvl: cLvl, max: 10 },
                    { ...SHOP.upgrade[1], cost: autoCost, lvl: aLvl, max: 10 }
                ];
            } else if (currentShopTab === 'buff') {
                items = SHOP.buff;
            } else if (currentShopTab === 'gadget') {
                items = SHOP.gadget;
            } else {
                items = SHOP[currentShopTab];
            }

            items.forEach(item => {
                const el = document.createElement('div');
                const owned = (state.pet.inventory.includes(item.id)) || (currentShopTab === 'house' && state.pet.inventory.includes('house_'+item.id));
                const isEquipped = (state.pet.wear && state.pet.wear.id === item.id) || (state.pet.house && state.pet.house.id === item.id);
                
                el.className = `shop-item ${owned && currentShopTab !== 'food' && currentShopTab !== 'buff' ? 'owned' : ''} ${isEquipped ? 'selected' : ''}`;
                
                let btnText = item.cost === 'MAX' ? '–ú–∞–∫—Å. –£—Ä.' : item.cost + ' üí∞';
                
                if(currentShopTab === 'wear' || currentShopTab === 'house') {
                    if(isEquipped) btnText = '–ù–∞–¥–µ—Ç–æ';
                    else if(owned) btnText = '–ù–∞–¥–µ—Ç—å';
                }
                
                if(currentShopTab === 'gadget') {
                     // Check active
                     if(state.pet.gadgets[item.id] > Date.now()) btnText = "–ê–∫—Ç–∏–≤–Ω–æ";
                }
                
                if(currentShopTab === 'upgrade') {
                    if(item.lvl >= item.max) btnText = "–ú–ê–ö–°–ò–ú–£–ú";
                    else btnText = `–£—Ä.${item.lvl+1} (${item.cost} üí∞)`;
                }

                el.innerHTML = `
                    <div style="font-size:30px">${item.ico}</div>
                    <div style="font-size:12px; font-weight:700">${item.name}</div>
                    <div class="shop-desc">${item.desc}</div>
                    <div class="shop-price">${btnText}</div>
                `;
                el.onclick = () => buyItem(item);
                lst.appendChild(el);
            });
        }

        function buyItem(item) {
            if(state.pet.coins < item.cost && item.cost !== 'MAX' && !state.pet.inventory.includes(item.id)) {
                 showToast("–ú–∞–ª–æ –º–æ–Ω–µ—Ç–æ–∫ üò¢"); return;
            }

            if(currentShopTab === 'food') {
                if(item.effect === 'bad') {
                    state.pet.coins -= item.cost;
                    state.pet.love = Math.max(0, state.pet.love - 10);
                    showToast("–ë–µ–µ! –Ø —Ç–∞–∫–æ–µ –Ω–µ –ª—é–±–ª—é! ü§¢");
                    savePet();
                    updatePetUI();
                    return;
                }
                
                state.pet.coins -= item.cost;
                const effects = item.effect.split(' ');
                effects.forEach(eff => {
                    const val = parseInt(eff.split('+')[1]);
                    if(eff.includes('h+')) state.pet.hunger = Math.min(100, state.pet.hunger + val);
                    if(eff.includes('e+')) state.pet.energy = Math.min(100, state.pet.energy + val);
                    if(eff.includes('l+')) state.pet.love = Math.min(100, state.pet.love + val);
                });
                
                showToast("–í–∫—É—Å–Ω–æ! üòã");
                addExp(10);
            }
            else if(currentShopTab === 'buff') {
                state.pet.coins -= item.cost;
                state.pet.activeBuffs.push({
                    id: item.id, type: item.type, val: item.val, ico: item.ico,
                    end: Date.now() + (item.dur * 1000)
                });
                showToast(`–≠—Ñ—Ñ–µ–∫—Ç "${item.name}" –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! ‚ú®`);
            }
            else if(currentShopTab === 'gadget') {
                if(state.pet.gadgets[item.id] > Date.now()) { showToast("–£–∂–µ –∞–∫—Ç–∏–≤–Ω–æ!"); return; }
                state.pet.coins -= item.cost;
                state.pet.gadgets[item.id] = Date.now() + (item.dur * 86400000);
                showToast("–ì–∞–¥–∂–µ—Ç —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ 7 –¥–Ω–µ–π! ü§ñ");
            }
            else if(currentShopTab === 'wear' || currentShopTab === 'house') {
                const invId = currentShopTab === 'house' ? 'house_'+item.id : item.id;
                if(state.pet.inventory.includes(invId)) {
                    if(currentShopTab === 'wear') state.pet.wear = item;
                    else state.pet.house = item;
                } else {
                    state.pet.coins -= item.cost;
                    state.pet.inventory.push(invId);
                    if(currentShopTab === 'wear') state.pet.wear = item;
                    else state.pet.house = item;
                    showToast("–ö—É–ø–ª–µ–Ω–æ! ‚ú®");
                }
            }
            else if(currentShopTab === 'upgrade') {
                if(item.lvl >= 10) return;
                state.pet.coins -= item.cost;
                if(item.type === 'u_click') { state.pet.upgrades.click++; state.pet.clickPower++; } 
                else { state.pet.upgrades.auto++; state.pet.autoIncome += 1; }
                showToast("–£–ª—É—á—à–µ–Ω–æ! üí™");
                addExp(50);
            }
            savePet();
            renderShop();
            updatePetUI();
        }

        // === COMMON UI & GRAPH ===
        window.setView = (v) => {
            document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active-view'));
            document.getElementById(`view-${v}`).classList.add('active-view');
            if(v === 'pet') {
                document.getElementById('btn-view-cal').classList.remove('active');
                document.getElementById('btn-view-pet').classList.add('active');
            } else {
                document.getElementById('btn-view-cal').classList.add('active');
                document.getElementById('btn-view-pet').classList.remove('active');
            }
        };

        window.setMode = (m) => { state.settings.mode = m; applySettings(); saveSettings(); };
        window.toggleGarland = () => { state.settings.garland = !state.settings.garland; applySettings(); saveSettings(); };
        window.toggleDark = () => { state.settings.dark = !state.settings.dark; applySettings(); saveSettings(); };
        window.doBarrelRoll = () => {
            const icon = document.getElementById('plane-icon');
            icon.style.animation = 'barrelRoll 1s ease-in-out';
            setTimeout(() => icon.style.animation = '', 1000);
            showToast("–í–∂—É—É—É—Ö! ‚úàÔ∏è");
        }

        let len = 0;
        function calcGraph() {
            const el = document.getElementById('flight-viz');
            if(!el) return;
            const w = el.offsetWidth; const h = el.offsetHeight;
            const d = `M 20 ${h-30} Q ${w/2} -20 ${w-20} ${h-50}`;
            DOM.track.setAttribute('d', d); DOM.active.setAttribute('d', d);
            len = DOM.track.getTotalLength();
        }

        function flightLoop() {
            const tot = END - START;
            const pass = new Date() - START;
            let p = pass / tot; if(p<0) p=0; if(p>1) p=1;
            if(DOM.active && DOM.track) {
                DOM.active.style.strokeDasharray = len;
                DOM.active.style.strokeDashoffset = len * (1 - p);
                const pt = DOM.track.getPointAtLength(len * p);
                const next = DOM.track.getPointAtLength(Math.min(len, len*p + 2));
                const ang = Math.atan2(next.y - pt.y, next.x - pt.x) * 180 / Math.PI;
                const hover = Math.sin(Date.now() / 800) * 3;
                DOM.plane.style.transform = `translate(${pt.x - 20}px, ${pt.y - 20 + hover}px) rotate(${ang}deg)`;
                DOM.pct.innerText = (p * 100).toFixed(5) + '%';
                DOM.pct.style.transform = `rotate(${-ang}deg)`;
            }
            requestAnimationFrame(flightLoop);
        }

        function runParticles() {
            const c = document.getElementById('canvas-fx');
            const ctx = c.getContext('2d');
            const rsz = () => { c.width = window.innerWidth; c.height = window.innerHeight; };
            window.addEventListener('resize', rsz); rsz();
            let pts = [];
            for(let i=0; i<80; i++) pts.push({
                x: Math.random()*c.width, y: Math.random()*c.height,
                z: Math.random()*0.5 + 0.5,
                s: Math.random()*Math.PI*2,
                v: Math.random()*0.02
            });

            function anim() {
                ctx.clearRect(0,0,c.width,c.height);
                const m = state.settings.mode;
                const isDark = state.settings.dark;
                pts.forEach(p => {
                    p.y += p.z * (m==='rain' ? 12 : 1);
                    p.x += Math.sin(p.y*0.003 + p.s)*0.5;
                    p.s += p.v;
                    if(p.y > c.height) { p.y = -20; p.x = Math.random()*c.width; }
                    ctx.beginPath();
                    if(m === 'snow') {
                        const rad = p.z * 3;
                        const grad = ctx.createRadialGradient(p.x, p.y, 0, p.x, p.y, rad);
                        grad.addColorStop(0, `rgba(255,255,255,${0.8*p.z})`);
                        grad.addColorStop(1, `rgba(255,255,255,0)`);
                        ctx.fillStyle = grad;
                        ctx.arc(p.x, p.y, rad, 0, Math.PI*2);
                        ctx.fill();
                    } else if(m === 'spring') {
                        ctx.save(); ctx.translate(p.x, p.y); ctx.scale(Math.cos(p.s), 1); ctx.rotate(p.s * 0.5);
                        ctx.fillStyle = `rgba(255, 192, 203, ${p.z})`;
                        ctx.moveTo(0,0); ctx.bezierCurveTo(5, -5, 10, 0, 0, 10); ctx.bezierCurveTo(-10, 0, -5, -5, 0, 0);
                        ctx.fill(); ctx.restore();
                    } else if(m === 'rain') {
                        const color = isDark ? `rgba(255,255,255,${0.3*p.z})` : `rgba(80, 100, 130, ${0.5*p.z})`;
                        ctx.strokeStyle = color; ctx.lineWidth = 1; ctx.moveTo(p.x, p.y); ctx.lineTo(p.x - 1, p.y + 15*p.z); ctx.stroke();
                    }
                });
                requestAnimationFrame(anim);
            }
            anim();
        }

        function renderCal() {
            DOM.mount.innerHTML = '';
            let ptr = new Date(START);
            const today = new Date(); today.setHours(0,0,0,0);
            while(ptr <= END) {
                const y = ptr.getFullYear(); const m = ptr.getMonth();
                const card = document.createElement('div'); card.className = 'glass-panel';
                const name = ptr.toLocaleString('ru', { month: 'long' });
                const ico = (m<=1 || m===11) ? '‚ùÑÔ∏è' : 'üå∏';
                card.innerHTML = `<div class="month-title">${ico} <span style="text-transform:capitalize">${name}</span></div>`;
                const wh = document.createElement('div'); wh.className = 'week-header';
                WEEKDAYS.forEach(wd => {
                    const el = document.createElement('div'); el.className = 'week-day'; el.innerText = wd;
                    wh.appendChild(el);
                });
                card.appendChild(wh);
                const grid = document.createElement('div'); grid.className = 'cal-grid';
                const f = new Date(y,m,1);
                let skip = f.getDay() - 1; if(skip===-1) skip=6;
                for(let i=0; i<skip; i++) grid.appendChild(document.createElement('div'));
                const days = new Date(y,m+1,0).getDate();
                for(let d=1; d<=days; d++) {
                    const date = new Date(y,m,d);
                    if(date < START && m===START.getMonth()) { grid.appendChild(document.createElement('div')); continue; }
                    if(date > END) break;
                    const k = date.toISOString().split('T')[0];
                    const fut = date > today;
                    const isT = date.getTime()===today.getTime();
                    const op = state.opened[k];
                    const holKey = `${m}-${d}`;
                    const el = document.createElement('div'); el.className = 'day-item';
                    el.innerText = d;
                    if(HOLIDAYS[holKey]) {
                        el.classList.add('holiday');
                        const hIco = document.createElement('div'); hIco.className = 'holiday-icon'; hIco.innerText = HOLIDAYS[holKey];
                        el.appendChild(hIco);
                    }
                    if(fut) {
                        el.classList.add('future');
                        el.onclick = () => { const dateStr = date.toLocaleString('ru', { day: 'numeric', month: 'long' }); showToast(`–ü–æ—Ç–µ—Ä–ø–∏, –ë–∏–±–∞! –û—Ç–∫—Ä—ã—Ç—å –º–æ–∂–Ω–æ ${dateStr}`); };
                    } else {
                        if(isT) el.classList.add('today');
                        if(op) { el.classList.add('opened'); addHeart(el); }
                        else if(!isT) el.classList.add('missed');
                        el.onclick = () => {
                            if(!state.opened[k]) { state.opened[k]=true; state.pet.coins += 50; savePet(); showToast("–ù–∞–π–¥–µ–Ω–æ: 50 –º–æ–Ω–µ—Ç! üí∞"); }
                            localStorage.setItem(DATA_KEY, JSON.stringify(state.opened));
                            el.classList.add('opened'); el.classList.remove('missed');
                            if(isT) el.classList.remove('today');
                            addHeart(el);
                            const diff = Math.floor((date - START)/(86400000));
                            const dateStr = date.toLocaleString('ru', { day: 'numeric', month: 'long' });
                            openLetter(dateStr, quotes[diff % quotes.length]);
                        }
                    }
                    grid.appendChild(el);
                }
                card.appendChild(grid); DOM.mount.appendChild(card);
                ptr = new Date(y,m+1,1);
            }
        }

        function addHeart(p) { if(p.querySelector('.mini-heart')) return; const h = document.createElement('span'); h.className = 'mini-heart'; h.innerText = '‚ù§'; p.appendChild(h); }
        function tick() {
            const rem = END - new Date();
            if(rem<=0) { document.getElementById('timer').innerText="–ú–´ –í–ú–ï–°–¢–ï!"; return; }
            const d = Math.floor(rem/86400000);
            const h = Math.floor((rem%86400000)/3600000);
            const m = Math.floor((rem%3600000)/60000);
            const s = Math.floor((rem%60000)/1000);
            document.getElementById('timer').innerText = `${d}–¥ ${("0"+h).slice(-2)}:${("0"+m).slice(-2)}:${("0"+s).slice(-2)}`;
        }
        function openLetter(d, q) { document.getElementById('m-date').innerText = d; document.getElementById('m-text').innerText = q.t; document.getElementById('m-source').innerText = "‚Äî " + q.s; DOM.modal.classList.add('active'); }
        window.closeModal = () => DOM.modal.classList.remove('active');
        let tm;
        function showToast(t) { document.getElementById('toast-text').innerText = t; DOM.toast.classList.add('visible'); clearTimeout(tm); tm = setTimeout(()=>DOM.toast.classList.remove('visible'), 2500); }

        init();
    </script>
</body>
</html>
